WebGLUtils=function(){var t=function(t){return'<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+t+"</div></div></td></tr></table>"},r='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',a='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>',n=function(t,r){for(var a=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,e=0;e<a.length;++e){try{n=t.getContext(a[e],r)}catch(t){}if(n)break}return n};return{create3DContext:n,setupWebGL:function(e,o,u){u=u||function(n){var o=e.parentNode;if(o){var u=window.WebGLRenderingContext?a:r;n&&(u+="<br/><br/>Status: "+n),o.innerHTML=t(u)}},e.addEventListener&&e.addEventListener("webglcontextcreationerror",function(t){u(t.statusMessage)},!1);var l=n(e,o);return l||window.WebGLRenderingContext||u(""),l}}}(),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,r){window.setTimeout(t,1e3/60)},function(t,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define(r);else{var a=r();for(var n in a)("object"==typeof exports?exports:t)[n]=a[n]}}(this,function(){return function(t){function r(n){if(a[n])return a[n].exports;var e=a[n]={exports:{},id:n,loaded:!1};return t[n].call(e.exports,e,e.exports,r),e.loaded=!0,e.exports}var a={};return r.m=t,r.c=a,r.p="",r(0)}([function(t,r,a){r.glMatrix=a(1),r.mat2=a(2),r.mat2d=a(3),r.mat3=a(4),r.mat4=a(5),r.quat=a(6),r.vec2=a(9),r.vec3=a(7),r.vec4=a(8)},function(t,r){var a={EPSILON:1e-6};a.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,a.RANDOM=Math.random,a.ENABLE_SIMD=!1,a.SIMD_AVAILABLE=a.ARRAY_TYPE===Float32Array&&"SIMD"in this,a.USE_SIMD=a.ENABLE_SIMD&&a.SIMD_AVAILABLE,a.setMatrixArrayType=function(t){a.ARRAY_TYPE=t};var n=Math.PI/180;a.toRadian=function(t){return t*n},t.exports=a},function(t,r,a){var n=a(1),e={create:function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},clone:function(t){var r=new n.ARRAY_TYPE(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},transpose:function(t,r){if(t===r){var a=r[1];t[1]=r[2],t[2]=a}else t[0]=r[0],t[1]=r[2],t[2]=r[1],t[3]=r[3];return t},invert:function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=a*o-e*n;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-e*u,t[3]=a*u,t):null},adjoint:function(t,r){var a=r[0];return t[0]=r[3],t[1]=-r[1],t[2]=-r[2],t[3]=a,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=a[0],i=a[1],c=a[2],s=a[3];return t[0]=n*l+o*i,t[1]=e*l+u*i,t[2]=n*c+o*s,t[3]=e*c+u*s,t}};e.mul=e.multiply,e.rotate=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=Math.sin(a),i=Math.cos(a);return t[0]=n*i+o*l,t[1]=e*i+u*l,t[2]=n*-l+o*i,t[3]=e*-l+u*i,t},e.scale=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=a[0],i=a[1];return t[0]=n*l,t[1]=e*l,t[2]=o*i,t[3]=u*i,t},e.fromRotation=function(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=a,t[2]=-a,t[3]=n,t},e.fromScaling=function(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,r,a,n){return t[2]=n[2]/n[0],a[0]=n[0],a[1]=n[1],a[3]=n[3]-t[2]*a[1],[t,r,a]},t.exports=e},function(t,r,a){var n=a(1),e={create:function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},clone:function(t){var r=new n.ARRAY_TYPE(6);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},invert:function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],l=r[5],i=a*o-n*e;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-e*i,t[3]=a*i,t[4]=(e*l-o*u)*i,t[5]=(n*u-a*l)*i,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=a[0],s=a[1],f=a[2],M=a[3],m=a[4],S=a[5];return t[0]=n*c+o*s,t[1]=e*c+u*s,t[2]=n*f+o*M,t[3]=e*f+u*M,t[4]=n*m+o*S+l,t[5]=e*m+u*S+i,t}};e.mul=e.multiply,e.rotate=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=Math.sin(a),s=Math.cos(a);return t[0]=n*s+o*c,t[1]=e*s+u*c,t[2]=n*-c+o*s,t[3]=e*-c+u*s,t[4]=l,t[5]=i,t},e.scale=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=a[0],s=a[1];return t[0]=n*c,t[1]=e*c,t[2]=o*s,t[3]=u*s,t[4]=l,t[5]=i,t},e.translate=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=a[0],s=a[1];return t[0]=n,t[1]=e,t[2]=o,t[3]=u,t[4]=n*c+o*s+l,t[5]=e*c+u*s+i,t},e.fromRotation=function(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=a,t[2]=-a,t[3]=n,t[4]=0,t[5]=0,t},e.fromScaling=function(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=r[0],t[5]=r[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},t.exports=e},function(t,r,a){var n=a(1),e={create:function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat4:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t},clone:function(t){var r=new n.ARRAY_TYPE(9);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,r){if(t===r){var a=r[1],n=r[2],e=r[5];t[1]=r[3],t[2]=r[6],t[3]=a,t[5]=r[7],t[6]=n,t[7]=e}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t},invert:function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],l=r[5],i=r[6],c=r[7],s=r[8],f=s*u-l*c,M=-s*o+l*i,m=c*o-u*i,S=a*f+n*M+e*m;return S?(S=1/S,t[0]=f*S,t[1]=(-s*n+e*c)*S,t[2]=(l*n-e*u)*S,t[3]=M*S,t[4]=(s*a-e*i)*S,t[5]=(-l*a+e*o)*S,t[6]=m*S,t[7]=(-c*a+n*i)*S,t[8]=(u*a-n*o)*S,t):null},adjoint:function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],l=r[5],i=r[6],c=r[7],s=r[8];return t[0]=u*s-l*c,t[1]=e*c-n*s,t[2]=n*l-e*u,t[3]=l*i-o*s,t[4]=a*s-e*i,t[5]=e*o-a*l,t[6]=o*c-u*i,t[7]=n*i-a*c,t[8]=a*u-n*o,t},determinant:function(t){var r=t[0],a=t[1],n=t[2],e=t[3],o=t[4],u=t[5],l=t[6],i=t[7],c=t[8];return r*(c*o-u*i)+a*(-c*e+u*l)+n*(i*e-o*l)},multiply:function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=r[6],s=r[7],f=r[8],M=a[0],m=a[1],S=a[2],x=a[3],D=a[4],v=a[5],I=a[6],F=a[7],h=a[8];return t[0]=M*n+m*u+S*c,t[1]=M*e+m*l+S*s,t[2]=M*o+m*i+S*f,t[3]=x*n+D*u+v*c,t[4]=x*e+D*l+v*s,t[5]=x*o+D*i+v*f,t[6]=I*n+F*u+h*c,t[7]=I*e+F*l+h*s,t[8]=I*o+F*i+h*f,t}};e.mul=e.multiply,e.translate=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=r[6],s=r[7],f=r[8],M=a[0],m=a[1];return t[0]=n,t[1]=e,t[2]=o,t[3]=u,t[4]=l,t[5]=i,t[6]=M*n+m*u+c,t[7]=M*e+m*l+s,t[8]=M*o+m*i+f,t},e.rotate=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=r[6],s=r[7],f=r[8],M=Math.sin(a),m=Math.cos(a);return t[0]=m*n+M*u,t[1]=m*e+M*l,t[2]=m*o+M*i,t[3]=m*u-M*n,t[4]=m*l-M*e,t[5]=m*i-M*o,t[6]=c,t[7]=s,t[8]=f,t},e.scale=function(t,r,a){var n=a[0],e=a[1];return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=e*r[3],t[4]=e*r[4],t[5]=e*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},e.fromTranslation=function(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=r[0],t[7]=r[1],t[8]=1,t},e.fromRotation=function(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=a,t[2]=0,t[3]=-a,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=r[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t},e.fromQuat=function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=a+a,l=n+n,i=e+e,c=a*u,s=n*u,f=n*l,M=e*u,m=e*l,S=e*i,x=o*u,D=o*l,v=o*i;return t[0]=1-f-S,t[3]=s-v,t[6]=M+D,t[1]=s+v,t[4]=1-c-S,t[7]=m-x,t[2]=M-D,t[5]=m+x,t[8]=1-c-f,t},e.normalFromMat4=function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],l=r[5],i=r[6],c=r[7],s=r[8],f=r[9],M=r[10],m=r[11],S=r[12],x=r[13],D=r[14],v=r[15],I=a*l-n*u,F=a*i-e*u,h=a*c-o*u,d=n*i-e*l,p=n*c-o*l,w=e*c-o*i,A=s*x-f*S,g=s*D-M*S,z=s*v-m*S,b=f*D-M*x,R=f*v-m*x,L=M*v-m*D,y=I*L-F*R+h*b+d*z-p*g+w*A;return y?(y=1/y,t[0]=(l*L-i*R+c*b)*y,t[1]=(i*z-u*L-c*g)*y,t[2]=(u*R-l*z+c*A)*y,t[3]=(e*R-n*L-o*b)*y,t[4]=(a*L-e*z+o*g)*y,t[5]=(n*z-a*R-o*A)*y,t[6]=(x*w-D*p+v*d)*y,t[7]=(D*h-S*w-v*F)*y,t[8]=(S*p-x*h+v*I)*y,t):null},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},t.exports=e},function(t,r,a){var n=a(1),e={scalar:{},SIMD:{},create:function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var r=new n.ARRAY_TYPE(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}};e.scalar.transpose=function(t,r){if(t===r){var a=r[1],n=r[2],e=r[3],o=r[6],u=r[7],l=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=a,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=o,t[11]=r[14],t[12]=e,t[13]=u,t[14]=l}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t},e.SIMD.transpose=function(t,r){var a,n,e,o,u,l,i,c,s,f;return a=SIMD.Float32x4.load(r,0),n=SIMD.Float32x4.load(r,4),e=SIMD.Float32x4.load(r,8),o=SIMD.Float32x4.load(r,12),u=SIMD.Float32x4.shuffle(a,n,0,1,4,5),l=SIMD.Float32x4.shuffle(e,o,0,1,4,5),i=SIMD.Float32x4.shuffle(u,l,0,2,4,6),c=SIMD.Float32x4.shuffle(u,l,1,3,5,7),SIMD.Float32x4.store(t,0,i),SIMD.Float32x4.store(t,4,c),u=SIMD.Float32x4.shuffle(a,n,2,3,6,7),l=SIMD.Float32x4.shuffle(e,o,2,3,6,7),s=SIMD.Float32x4.shuffle(u,l,0,2,4,6),f=SIMD.Float32x4.shuffle(u,l,1,3,5,7),SIMD.Float32x4.store(t,8,s),SIMD.Float32x4.store(t,12,f),t},e.transpose=n.USE_SIMD?e.SIMD.transpose:e.scalar.transpose,e.scalar.invert=function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],l=r[5],i=r[6],c=r[7],s=r[8],f=r[9],M=r[10],m=r[11],S=r[12],x=r[13],D=r[14],v=r[15],I=a*l-n*u,F=a*i-e*u,h=a*c-o*u,d=n*i-e*l,p=n*c-o*l,w=e*c-o*i,A=s*x-f*S,g=s*D-M*S,z=s*v-m*S,b=f*D-M*x,R=f*v-m*x,L=M*v-m*D,y=I*L-F*R+h*b+d*z-p*g+w*A;return y?(y=1/y,t[0]=(l*L-i*R+c*b)*y,t[1]=(e*R-n*L-o*b)*y,t[2]=(x*w-D*p+v*d)*y,t[3]=(M*p-f*w-m*d)*y,t[4]=(i*z-u*L-c*g)*y,t[5]=(a*L-e*z+o*g)*y,t[6]=(D*h-S*w-v*F)*y,t[7]=(s*w-M*h+m*F)*y,t[8]=(u*R-l*z+c*A)*y,t[9]=(n*z-a*R-o*A)*y,t[10]=(S*p-x*h+v*I)*y,t[11]=(f*h-s*p-m*I)*y,t[12]=(l*g-u*b-i*A)*y,t[13]=(a*b-n*g+e*A)*y,t[14]=(x*F-S*d-D*I)*y,t[15]=(s*d-f*F+M*I)*y,t):null},e.SIMD.invert=function(t,r){var a,n,e,o,u,l,i,c,s,f,M=SIMD.Float32x4.load(r,0),m=SIMD.Float32x4.load(r,4),S=SIMD.Float32x4.load(r,8),x=SIMD.Float32x4.load(r,12);return u=SIMD.Float32x4.shuffle(M,m,0,1,4,5),n=SIMD.Float32x4.shuffle(S,x,0,1,4,5),a=SIMD.Float32x4.shuffle(u,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,u,1,3,5,7),u=SIMD.Float32x4.shuffle(M,m,2,3,6,7),o=SIMD.Float32x4.shuffle(S,x,2,3,6,7),e=SIMD.Float32x4.shuffle(u,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,u,1,3,5,7),u=SIMD.Float32x4.mul(e,o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),l=SIMD.Float32x4.mul(n,u),i=SIMD.Float32x4.mul(a,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,u),l),i=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,u),i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.mul(n,e),u=SIMD.Float32x4.swizzle(u,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),l),s=SIMD.Float32x4.mul(a,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,u)),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,u),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),e=SIMD.Float32x4.swizzle(e,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,u),l),c=SIMD.Float32x4.mul(a,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(e,u)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,u),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),u=SIMD.Float32x4.mul(a,n),u=SIMD.Float32x4.swizzle(u,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),c),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,u),s),u=SIMD.Float32x4.swizzle(u,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,u),c),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(e,u)),u=SIMD.Float32x4.mul(a,o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),i=SIMD.Float32x4.sub(i,SIMD.Float32x4.mul(e,u)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,u),c),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,u),i),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,u)),u=SIMD.Float32x4.mul(a,e),u=SIMD.Float32x4.swizzle(u,1,0,3,2),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),i),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,u)),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.sub(i,SIMD.Float32x4.mul(o,u)),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,u),s),f=SIMD.Float32x4.mul(a,l),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),u=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(u,u),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(u,u))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,i)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,c)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,s)),t):null},e.invert=n.USE_SIMD?e.SIMD.invert:e.scalar.invert,e.scalar.adjoint=function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=r[4],l=r[5],i=r[6],c=r[7],s=r[8],f=r[9],M=r[10],m=r[11],S=r[12],x=r[13],D=r[14],v=r[15];return t[0]=l*(M*v-m*D)-f*(i*v-c*D)+x*(i*m-c*M),t[1]=-(n*(M*v-m*D)-f*(e*v-o*D)+x*(e*m-o*M)),t[2]=n*(i*v-c*D)-l*(e*v-o*D)+x*(e*c-o*i),t[3]=-(n*(i*m-c*M)-l*(e*m-o*M)+f*(e*c-o*i)),t[4]=-(u*(M*v-m*D)-s*(i*v-c*D)+S*(i*m-c*M)),t[5]=a*(M*v-m*D)-s*(e*v-o*D)+S*(e*m-o*M),t[6]=-(a*(i*v-c*D)-u*(e*v-o*D)+S*(e*c-o*i)),t[7]=a*(i*m-c*M)-u*(e*m-o*M)+s*(e*c-o*i),t[8]=u*(f*v-m*x)-s*(l*v-c*x)+S*(l*m-c*f),t[9]=-(a*(f*v-m*x)-s*(n*v-o*x)+S*(n*m-o*f)),t[10]=a*(l*v-c*x)-u*(n*v-o*x)+S*(n*c-o*l),t[11]=-(a*(l*m-c*f)-u*(n*m-o*f)+s*(n*c-o*l)),t[12]=-(u*(f*D-M*x)-s*(l*D-i*x)+S*(l*M-i*f)),t[13]=a*(f*D-M*x)-s*(n*D-e*x)+S*(n*M-e*f),t[14]=-(a*(l*D-i*x)-u*(n*D-e*x)+S*(n*i-e*l)),t[15]=a*(l*M-i*f)-u*(n*M-e*f)+s*(n*i-e*l),t},e.SIMD.adjoint=function(t,r){var a,n,e,o,u,l,i,c,s,f=SIMD.Float32x4.load(r,0),M=SIMD.Float32x4.load(r,4),m=SIMD.Float32x4.load(r,8),S=SIMD.Float32x4.load(r,12);return u=SIMD.Float32x4.shuffle(f,M,0,1,4,5),n=SIMD.Float32x4.shuffle(m,S,0,1,4,5),a=SIMD.Float32x4.shuffle(u,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,u,1,3,5,7),u=SIMD.Float32x4.shuffle(f,M,2,3,6,7),o=SIMD.Float32x4.shuffle(m,S,2,3,6,7),e=SIMD.Float32x4.shuffle(u,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,u,1,3,5,7),u=SIMD.Float32x4.mul(e,o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),l=SIMD.Float32x4.mul(n,u),i=SIMD.Float32x4.mul(a,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,u),l),i=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,u),i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.mul(n,e),u=SIMD.Float32x4.swizzle(u,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),l),s=SIMD.Float32x4.mul(a,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,u)),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,u),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),e=SIMD.Float32x4.swizzle(e,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,u),l),c=SIMD.Float32x4.mul(a,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(e,u)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,u),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),u=SIMD.Float32x4.mul(a,n),u=SIMD.Float32x4.swizzle(u,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),c),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,u),s),u=SIMD.Float32x4.swizzle(u,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,u),c),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(e,u)),u=SIMD.Float32x4.mul(a,o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),i=SIMD.Float32x4.sub(i,SIMD.Float32x4.mul(e,u)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,u),c),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,u),i),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,u)),u=SIMD.Float32x4.mul(a,e),u=SIMD.Float32x4.swizzle(u,1,0,3,2),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),i),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,u)),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.sub(i,SIMD.Float32x4.mul(o,u)),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,u),s),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,i),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,s),t},e.adjoint=n.USE_SIMD?e.SIMD.adjoint:e.scalar.adjoint,e.determinant=function(t){var r=t[0],a=t[1],n=t[2],e=t[3],o=t[4],u=t[5],l=t[6],i=t[7],c=t[8],s=t[9],f=t[10],M=t[11],m=t[12],S=t[13],x=t[14],D=t[15];return(r*u-a*o)*(f*D-M*x)-(r*l-n*o)*(s*D-M*S)+(r*i-e*o)*(s*x-f*S)+(a*l-n*u)*(c*D-M*m)-(a*i-e*u)*(c*x-f*m)+(n*i-e*l)*(c*S-s*m)},e.SIMD.multiply=function(t,r,a){var n=SIMD.Float32x4.load(r,0),e=SIMD.Float32x4.load(r,4),o=SIMD.Float32x4.load(r,8),u=SIMD.Float32x4.load(r,12),l=SIMD.Float32x4.load(a,0),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),u))));SIMD.Float32x4.store(t,0,i);var c=SIMD.Float32x4.load(a,4),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),u))));SIMD.Float32x4.store(t,4,s);var f=SIMD.Float32x4.load(a,8),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),u))));SIMD.Float32x4.store(t,8,M);var m=SIMD.Float32x4.load(a,12),S=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,3,3,3,3),u))));return SIMD.Float32x4.store(t,12,S),t},e.scalar.multiply=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=r[6],s=r[7],f=r[8],M=r[9],m=r[10],S=r[11],x=r[12],D=r[13],v=r[14],I=r[15],F=a[0],h=a[1],d=a[2],p=a[3];return t[0]=F*n+h*l+d*f+p*x,t[1]=F*e+h*i+d*M+p*D,t[2]=F*o+h*c+d*m+p*v,t[3]=F*u+h*s+d*S+p*I,F=a[4],h=a[5],d=a[6],p=a[7],t[4]=F*n+h*l+d*f+p*x,t[5]=F*e+h*i+d*M+p*D,t[6]=F*o+h*c+d*m+p*v,t[7]=F*u+h*s+d*S+p*I,F=a[8],h=a[9],d=a[10],p=a[11],t[8]=F*n+h*l+d*f+p*x,t[9]=F*e+h*i+d*M+p*D,t[10]=F*o+h*c+d*m+p*v,t[11]=F*u+h*s+d*S+p*I,F=a[12],h=a[13],d=a[14],p=a[15],t[12]=F*n+h*l+d*f+p*x,t[13]=F*e+h*i+d*M+p*D,t[14]=F*o+h*c+d*m+p*v,t[15]=F*u+h*s+d*S+p*I,t},e.multiply=n.USE_SIMD?e.SIMD.multiply:e.scalar.multiply,e.mul=e.multiply,e.scalar.translate=function(t,r,a){var n,e,o,u,l,i,c,s,f,M,m,S,x=a[0],D=a[1],v=a[2];return r===t?(t[12]=r[0]*x+r[4]*D+r[8]*v+r[12],t[13]=r[1]*x+r[5]*D+r[9]*v+r[13],t[14]=r[2]*x+r[6]*D+r[10]*v+r[14],t[15]=r[3]*x+r[7]*D+r[11]*v+r[15]):(n=r[0],e=r[1],o=r[2],u=r[3],l=r[4],i=r[5],c=r[6],s=r[7],f=r[8],M=r[9],m=r[10],S=r[11],t[0]=n,t[1]=e,t[2]=o,t[3]=u,t[4]=l,t[5]=i,t[6]=c,t[7]=s,t[8]=f,t[9]=M,t[10]=m,t[11]=S,t[12]=n*x+l*D+f*v+r[12],t[13]=e*x+i*D+M*v+r[13],t[14]=o*x+c*D+m*v+r[14],t[15]=u*x+s*D+S*v+r[15]),t},e.SIMD.translate=function(t,r,a){var n=SIMD.Float32x4.load(r,0),e=SIMD.Float32x4.load(r,4),o=SIMD.Float32x4.load(r,8),u=SIMD.Float32x4.load(r,12),l=SIMD.Float32x4(a[0],a[1],a[2],0);r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(l,0,0,0,0)),e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(l,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(l,2,2,2,2));var i=SIMD.Float32x4.add(n,SIMD.Float32x4.add(e,SIMD.Float32x4.add(o,u)));return SIMD.Float32x4.store(t,12,i),t},e.translate=n.USE_SIMD?e.SIMD.translate:e.scalar.translate,e.scalar.scale=function(t,r,a){var n=a[0],e=a[1],o=a[2];return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=r[11]*o,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},e.SIMD.scale=function(t,r,a){var n,e,o,u=SIMD.Float32x4(a[0],a[1],a[2],0);return n=SIMD.Float32x4.load(r,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(u,0,0,0,0))),e=SIMD.Float32x4.load(r,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(u,1,1,1,1))),o=SIMD.Float32x4.load(r,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2))),t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},e.scale=n.USE_SIMD?e.SIMD.scale:e.scalar.scale,e.rotate=function(t,r,a,e){var o,u,l,i,c,s,f,M,m,S,x,D,v,I,F,h,d,p,w,A,g,z,b,R,L=e[0],y=e[1],E=e[2],q=Math.sqrt(L*L+y*y+E*E);return Math.abs(q)<n.EPSILON?null:(L*=q=1/q,y*=q,E*=q,o=Math.sin(a),l=1-(u=Math.cos(a)),i=r[0],c=r[1],s=r[2],f=r[3],M=r[4],m=r[5],S=r[6],x=r[7],D=r[8],v=r[9],I=r[10],F=r[11],h=L*L*l+u,d=y*L*l+E*o,p=E*L*l-y*o,w=L*y*l-E*o,A=y*y*l+u,g=E*y*l+L*o,z=L*E*l+y*o,b=y*E*l-L*o,R=E*E*l+u,t[0]=i*h+M*d+D*p,t[1]=c*h+m*d+v*p,t[2]=s*h+S*d+I*p,t[3]=f*h+x*d+F*p,t[4]=i*w+M*A+D*g,t[5]=c*w+m*A+v*g,t[6]=s*w+S*A+I*g,t[7]=f*w+x*A+F*g,t[8]=i*z+M*b+D*R,t[9]=c*z+m*b+v*R,t[10]=s*z+S*b+I*R,t[11]=f*z+x*b+F*R,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)},e.rotateX=function(t,r,a){var n=Math.sin(a),e=Math.cos(a),o=r[4],u=r[5],l=r[6],i=r[7],c=r[8],s=r[9],f=r[10],M=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=o*e+c*n,t[5]=u*e+s*n,t[6]=l*e+f*n,t[7]=i*e+M*n,t[8]=c*e-o*n,t[9]=s*e-u*n,t[10]=f*e-l*n,t[11]=M*e-i*n,t},e.rotateY=function(t,r,a){var n=Math.sin(a),e=Math.cos(a),o=r[0],u=r[1],l=r[2],i=r[3],c=r[8],s=r[9],f=r[10],M=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*e-c*n,t[1]=u*e-s*n,t[2]=l*e-f*n,t[3]=i*e-M*n,t[8]=o*n+c*e,t[9]=u*n+s*e,t[10]=l*n+f*e,t[11]=i*n+M*e,t},e.rotateZ=function(t,r,a){var n=Math.sin(a),e=Math.cos(a),o=r[0],u=r[1],l=r[2],i=r[3],c=r[4],s=r[5],f=r[6],M=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*e+c*n,t[1]=u*e+s*n,t[2]=l*e+f*n,t[3]=i*e+M*n,t[4]=c*e-o*n,t[5]=s*e-u*n,t[6]=f*e-l*n,t[7]=M*e-i*n,t},e.fromTranslation=function(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.fromScaling=function(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,r,a){var e,o,u,l=a[0],i=a[1],c=a[2],s=Math.sqrt(l*l+i*i+c*c);return Math.abs(s)<n.EPSILON?null:(l*=s=1/s,i*=s,c*=s,e=Math.sin(r),u=1-(o=Math.cos(r)),t[0]=l*l*u+o,t[1]=i*l*u+c*e,t[2]=c*l*u-i*e,t[3]=0,t[4]=l*i*u-c*e,t[5]=i*i*u+o,t[6]=c*i*u+l*e,t[7]=0,t[8]=l*c*u+i*e,t[9]=i*c*u-l*e,t[10]=c*c*u+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=n+n,i=e+e,c=o+o,s=n*l,f=n*i,M=n*c,m=e*i,S=e*c,x=o*c,D=u*l,v=u*i,I=u*c;return t[0]=1-(m+x),t[1]=f+I,t[2]=M-v,t[3]=0,t[4]=f-I,t[5]=1-(s+x),t[6]=S+D,t[7]=0,t[8]=M+v,t[9]=S-D,t[10]=1-(s+m),t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},e.fromRotationTranslationScale=function(t,r,a,n){var e=r[0],o=r[1],u=r[2],l=r[3],i=e+e,c=o+o,s=u+u,f=e*i,M=e*c,m=e*s,S=o*c,x=o*s,D=u*s,v=l*i,I=l*c,F=l*s,h=n[0],d=n[1],p=n[2];return t[0]=(1-(S+D))*h,t[1]=(M+F)*h,t[2]=(m-I)*h,t[3]=0,t[4]=(M-F)*d,t[5]=(1-(f+D))*d,t[6]=(x+v)*d,t[7]=0,t[8]=(m+I)*p,t[9]=(x-v)*p,t[10]=(1-(f+S))*p,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,r,a,n,e){var o=r[0],u=r[1],l=r[2],i=r[3],c=o+o,s=u+u,f=l+l,M=o*c,m=o*s,S=o*f,x=u*s,D=u*f,v=l*f,I=i*c,F=i*s,h=i*f,d=n[0],p=n[1],w=n[2],A=e[0],g=e[1],z=e[2];return t[0]=(1-(x+v))*d,t[1]=(m+h)*d,t[2]=(S-F)*d,t[3]=0,t[4]=(m-h)*p,t[5]=(1-(M+v))*p,t[6]=(D+I)*p,t[7]=0,t[8]=(S+F)*w,t[9]=(D-I)*w,t[10]=(1-(M+x))*w,t[11]=0,t[12]=a[0]+A-(t[0]*A+t[4]*g+t[8]*z),t[13]=a[1]+g-(t[1]*A+t[5]*g+t[9]*z),t[14]=a[2]+z-(t[2]*A+t[6]*g+t[10]*z),t[15]=1,t},e.fromQuat=function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=a+a,l=n+n,i=e+e,c=a*u,s=n*u,f=n*l,M=e*u,m=e*l,S=e*i,x=o*u,D=o*l,v=o*i;return t[0]=1-f-S,t[1]=s+v,t[2]=M-D,t[3]=0,t[4]=s-v,t[5]=1-c-S,t[6]=m+x,t[7]=0,t[8]=M+D,t[9]=m-x,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,r,a,n,e,o,u){var l=1/(a-r),i=1/(e-n),c=1/(o-u);return t[0]=2*o*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*i,t[6]=0,t[7]=0,t[8]=(a+r)*l,t[9]=(e+n)*i,t[10]=(u+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*o*2*c,t[15]=0,t},e.perspective=function(t,r,a,n,e){var o=1/Math.tan(r/2),u=1/(n-e);return t[0]=o/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+n)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*n*u,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,r,a,n){var e=Math.tan(r.upDegrees*Math.PI/180),o=Math.tan(r.downDegrees*Math.PI/180),u=Math.tan(r.leftDegrees*Math.PI/180),l=Math.tan(r.rightDegrees*Math.PI/180),i=2/(u+l),c=2/(e+o);return t[0]=i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(u-l)*i*.5,t[9]=(e-o)*c*.5,t[10]=n/(a-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*a/(a-n),t[15]=0,t},e.ortho=function(t,r,a,n,e,o,u){var l=1/(r-a),i=1/(n-e),c=1/(o-u);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(r+a)*l,t[13]=(e+n)*i,t[14]=(u+o)*c,t[15]=1,t},e.lookAt=function(t,r,a,o){var u,l,i,c,s,f,M,m,S,x,D=r[0],v=r[1],I=r[2],F=o[0],h=o[1],d=o[2],p=a[0],w=a[1],A=a[2];return Math.abs(D-p)<n.EPSILON&&Math.abs(v-w)<n.EPSILON&&Math.abs(I-A)<n.EPSILON?e.identity(t):(M=D-p,m=v-w,S=I-A,u=h*(S*=x=1/Math.sqrt(M*M+m*m+S*S))-d*(m*=x),l=d*(M*=x)-F*S,i=F*m-h*M,(x=Math.sqrt(u*u+l*l+i*i))?(u*=x=1/x,l*=x,i*=x):(u=0,l=0,i=0),c=m*i-S*l,s=S*u-M*i,f=M*l-m*u,(x=Math.sqrt(c*c+s*s+f*f))?(c*=x=1/x,s*=x,f*=x):(c=0,s=0,f=0),t[0]=u,t[1]=c,t[2]=M,t[3]=0,t[4]=l,t[5]=s,t[6]=m,t[7]=0,t[8]=i,t[9]=f,t[10]=S,t[11]=0,t[12]=-(u*D+l*v+i*I),t[13]=-(c*D+s*v+f*I),t[14]=-(M*D+m*v+S*I),t[15]=1,t)},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},t.exports=e},function(t,r,a){var n=a(1),e=a(4),o=a(7),u=a(8),l={create:function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}};l.rotationTo=function(){var t=o.create(),r=o.fromValues(1,0,0),a=o.fromValues(0,1,0);return function(n,e,u){var i=o.dot(e,u);return-.999999>i?(o.cross(t,r,e),o.length(t)<1e-6&&o.cross(t,a,e),o.normalize(t,t),l.setAxisAngle(n,t,Math.PI),n):i>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,e,u),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+i,l.normalize(n,n))}}(),l.setAxes=function(){var t=e.create();return function(r,a,n,e){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=e[0],t[4]=e[1],t[7]=e[2],t[2]=-a[0],t[5]=-a[1],t[8]=-a[2],l.normalize(r,l.fromMat3(r,t))}}(),l.clone=u.clone,l.fromValues=u.fromValues,l.copy=u.copy,l.set=u.set,l.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},l.setAxisAngle=function(t,r,a){a*=.5;var n=Math.sin(a);return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=Math.cos(a),t},l.add=u.add,l.multiply=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3],l=a[0],i=a[1],c=a[2],s=a[3];return t[0]=n*s+u*l+e*c-o*i,t[1]=e*s+u*i+o*l-n*c,t[2]=o*s+u*c+n*i-e*l,t[3]=u*s-n*l-e*i-o*c,t},l.mul=l.multiply,l.scale=u.scale,l.rotateX=function(t,r,a){a*=.5;var n=r[0],e=r[1],o=r[2],u=r[3],l=Math.sin(a),i=Math.cos(a);return t[0]=n*i+u*l,t[1]=e*i+o*l,t[2]=o*i-e*l,t[3]=u*i-n*l,t},l.rotateY=function(t,r,a){a*=.5;var n=r[0],e=r[1],o=r[2],u=r[3],l=Math.sin(a),i=Math.cos(a);return t[0]=n*i-o*l,t[1]=e*i+u*l,t[2]=o*i+n*l,t[3]=u*i-e*l,t},l.rotateZ=function(t,r,a){a*=.5;var n=r[0],e=r[1],o=r[2],u=r[3],l=Math.sin(a),i=Math.cos(a);return t[0]=n*i+e*l,t[1]=e*i-n*l,t[2]=o*i+u*l,t[3]=u*i-o*l,t},l.calculateW=function(t,r){var a=r[0],n=r[1],e=r[2];return t[0]=a,t[1]=n,t[2]=e,t[3]=Math.sqrt(Math.abs(1-a*a-n*n-e*e)),t},l.dot=u.dot,l.lerp=u.lerp,l.slerp=function(t,r,a,n){var e,o,u,l,i,c=r[0],s=r[1],f=r[2],M=r[3],m=a[0],S=a[1],x=a[2],D=a[3];return 0>(o=c*m+s*S+f*x+M*D)&&(o=-o,m=-m,S=-S,x=-x,D=-D),1-o>1e-6?(e=Math.acos(o),u=Math.sin(e),l=Math.sin((1-n)*e)/u,i=Math.sin(n*e)/u):(l=1-n,i=n),t[0]=l*c+i*m,t[1]=l*s+i*S,t[2]=l*f+i*x,t[3]=l*M+i*D,t},l.sqlerp=function(){var t=l.create(),r=l.create();return function(a,n,e,o,u,i){return l.slerp(t,n,u,i),l.slerp(r,e,o,i),l.slerp(a,t,r,2*i*(1-i)),a}}(),l.invert=function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=a*a+n*n+e*e+o*o,l=u?1/u:0;return t[0]=-a*l,t[1]=-n*l,t[2]=-e*l,t[3]=o*l,t},l.conjugate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t},l.length=u.length,l.len=l.length,l.squaredLength=u.squaredLength,l.sqrLen=l.squaredLength,l.normalize=u.normalize,l.fromMat3=function(t,r){var a,n=r[0]+r[4]+r[8];if(n>0)a=Math.sqrt(n+1),t[3]=.5*a,a=.5/a,t[0]=(r[5]-r[7])*a,t[1]=(r[6]-r[2])*a,t[2]=(r[1]-r[3])*a;else{var e=0;r[4]>r[0]&&(e=1),r[8]>r[3*e+e]&&(e=2);var o=(e+1)%3,u=(e+2)%3;a=Math.sqrt(r[3*e+e]-r[3*o+o]-r[3*u+u]+1),t[e]=.5*a,a=.5/a,t[3]=(r[3*o+u]-r[3*u+o])*a,t[o]=(r[3*o+e]+r[3*e+o])*a,t[u]=(r[3*u+e]+r[3*e+u])*a}return t},l.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=l},function(t,r,a){var n=a(1),e={create:function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var r=new n.ARRAY_TYPE(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},fromValues:function(t,r,a){var e=new n.ARRAY_TYPE(3);return e[0]=t,e[1]=r,e[2]=a,e},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},set:function(t,r,a,n){return t[0]=r,t[1]=a,t[2]=n,t},add:function(t,r,a){return t[0]=r[0]+a[0],t[1]=r[1]+a[1],t[2]=r[2]+a[2],t},subtract:function(t,r,a){return t[0]=r[0]-a[0],t[1]=r[1]-a[1],t[2]=r[2]-a[2],t}};e.sub=e.subtract,e.multiply=function(t,r,a){return t[0]=r[0]*a[0],t[1]=r[1]*a[1],t[2]=r[2]*a[2],t},e.mul=e.multiply,e.divide=function(t,r,a){return t[0]=r[0]/a[0],t[1]=r[1]/a[1],t[2]=r[2]/a[2],t},e.div=e.divide,e.min=function(t,r,a){return t[0]=Math.min(r[0],a[0]),t[1]=Math.min(r[1],a[1]),t[2]=Math.min(r[2],a[2]),t},e.max=function(t,r,a){return t[0]=Math.max(r[0],a[0]),t[1]=Math.max(r[1],a[1]),t[2]=Math.max(r[2],a[2]),t},e.scale=function(t,r,a){return t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t},e.scaleAndAdd=function(t,r,a,n){return t[0]=r[0]+a[0]*n,t[1]=r[1]+a[1]*n,t[2]=r[2]+a[2]*n,t},e.distance=function(t,r){var a=r[0]-t[0],n=r[1]-t[1],e=r[2]-t[2];return Math.sqrt(a*a+n*n+e*e)},e.dist=e.distance,e.squaredDistance=function(t,r){var a=r[0]-t[0],n=r[1]-t[1],e=r[2]-t[2];return a*a+n*n+e*e},e.sqrDist=e.squaredDistance,e.length=function(t){var r=t[0],a=t[1],n=t[2];return Math.sqrt(r*r+a*a+n*n)},e.len=e.length,e.squaredLength=function(t){var r=t[0],a=t[1],n=t[2];return r*r+a*a+n*n},e.sqrLen=e.squaredLength,e.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t},e.inverse=function(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t},e.normalize=function(t,r){var a=r[0],n=r[1],e=r[2],o=a*a+n*n+e*e;return o>0&&(o=1/Math.sqrt(o),t[0]=r[0]*o,t[1]=r[1]*o,t[2]=r[2]*o),t},e.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.cross=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=a[0],l=a[1],i=a[2];return t[0]=e*i-o*l,t[1]=o*u-n*i,t[2]=n*l-e*u,t},e.lerp=function(t,r,a,n){var e=r[0],o=r[1],u=r[2];return t[0]=e+n*(a[0]-e),t[1]=o+n*(a[1]-o),t[2]=u+n*(a[2]-u),t},e.hermite=function(t,r,a,n,e,o){var u=o*o,l=u*(2*o-3)+1,i=u*(o-2)+o,c=u*(o-1),s=u*(3-2*o);return t[0]=r[0]*l+a[0]*i+n[0]*c+e[0]*s,t[1]=r[1]*l+a[1]*i+n[1]*c+e[1]*s,t[2]=r[2]*l+a[2]*i+n[2]*c+e[2]*s,t},e.bezier=function(t,r,a,n,e,o){var u=1-o,l=u*u,i=o*o,c=l*u,s=3*o*l,f=3*i*u,M=i*o;return t[0]=r[0]*c+a[0]*s+n[0]*f+e[0]*M,t[1]=r[1]*c+a[1]*s+n[1]*f+e[1]*M,t[2]=r[2]*c+a[2]*s+n[2]*f+e[2]*M,t},e.random=function(t,r){r=r||1;var a=2*n.RANDOM()*Math.PI,e=2*n.RANDOM()-1,o=Math.sqrt(1-e*e)*r;return t[0]=Math.cos(a)*o,t[1]=Math.sin(a)*o,t[2]=e*r,t},e.transformMat4=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=a[3]*n+a[7]*e+a[11]*o+a[15];return u=u||1,t[0]=(a[0]*n+a[4]*e+a[8]*o+a[12])/u,t[1]=(a[1]*n+a[5]*e+a[9]*o+a[13])/u,t[2]=(a[2]*n+a[6]*e+a[10]*o+a[14])/u,t},e.transformMat3=function(t,r,a){var n=r[0],e=r[1],o=r[2];return t[0]=n*a[0]+e*a[3]+o*a[6],t[1]=n*a[1]+e*a[4]+o*a[7],t[2]=n*a[2]+e*a[5]+o*a[8],t},e.transformQuat=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=a[0],l=a[1],i=a[2],c=a[3],s=c*n+l*o-i*e,f=c*e+i*n-u*o,M=c*o+u*e-l*n,m=-u*n-l*e-i*o;return t[0]=s*c+m*-u+f*-i-M*-l,t[1]=f*c+m*-l+M*-u-s*-i,t[2]=M*c+m*-i+s*-l-f*-u,t},e.rotateX=function(t,r,a,n){var e=[],o=[];return e[0]=r[0]-a[0],e[1]=r[1]-a[1],e[2]=r[2]-a[2],o[0]=e[0],o[1]=e[1]*Math.cos(n)-e[2]*Math.sin(n),o[2]=e[1]*Math.sin(n)+e[2]*Math.cos(n),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},e.rotateY=function(t,r,a,n){var e=[],o=[];return e[0]=r[0]-a[0],e[1]=r[1]-a[1],e[2]=r[2]-a[2],o[0]=e[2]*Math.sin(n)+e[0]*Math.cos(n),o[1]=e[1],o[2]=e[2]*Math.cos(n)-e[0]*Math.sin(n),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},e.rotateZ=function(t,r,a,n){var e=[],o=[];return e[0]=r[0]-a[0],e[1]=r[1]-a[1],e[2]=r[2]-a[2],o[0]=e[0]*Math.cos(n)-e[1]*Math.sin(n),o[1]=e[0]*Math.sin(n)+e[1]*Math.cos(n),o[2]=e[2],t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},e.forEach=function(){var t=e.create();return function(r,a,n,e,o,u){var l,i;for(a||(a=3),n||(n=0),i=e?Math.min(e*a+n,r.length):r.length,l=n;i>l;l+=a)t[0]=r[l],t[1]=r[l+1],t[2]=r[l+2],o(t,t,u),r[l]=t[0],r[l+1]=t[1],r[l+2]=t[2];return r}}(),e.angle=function(t,r){var a=e.fromValues(t[0],t[1],t[2]),n=e.fromValues(r[0],r[1],r[2]);e.normalize(a,a),e.normalize(n,n);var o=e.dot(a,n);return o>1?0:Math.acos(o)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t.exports=e},function(t,r,a){var n=a(1),e={create:function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var r=new n.ARRAY_TYPE(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},fromValues:function(t,r,a,e){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=r,o[2]=a,o[3]=e,o},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},set:function(t,r,a,n,e){return t[0]=r,t[1]=a,t[2]=n,t[3]=e,t},add:function(t,r,a){return t[0]=r[0]+a[0],t[1]=r[1]+a[1],t[2]=r[2]+a[2],t[3]=r[3]+a[3],t},subtract:function(t,r,a){return t[0]=r[0]-a[0],t[1]=r[1]-a[1],t[2]=r[2]-a[2],t[3]=r[3]-a[3],t}};e.sub=e.subtract,e.multiply=function(t,r,a){return t[0]=r[0]*a[0],t[1]=r[1]*a[1],t[2]=r[2]*a[2],t[3]=r[3]*a[3],t},e.mul=e.multiply,e.divide=function(t,r,a){return t[0]=r[0]/a[0],t[1]=r[1]/a[1],t[2]=r[2]/a[2],t[3]=r[3]/a[3],t},e.div=e.divide,e.min=function(t,r,a){return t[0]=Math.min(r[0],a[0]),t[1]=Math.min(r[1],a[1]),t[2]=Math.min(r[2],a[2]),t[3]=Math.min(r[3],a[3]),t},e.max=function(t,r,a){return t[0]=Math.max(r[0],a[0]),t[1]=Math.max(r[1],a[1]),t[2]=Math.max(r[2],a[2]),t[3]=Math.max(r[3],a[3]),t},e.scale=function(t,r,a){return t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t[3]=r[3]*a,t},e.scaleAndAdd=function(t,r,a,n){return t[0]=r[0]+a[0]*n,t[1]=r[1]+a[1]*n,t[2]=r[2]+a[2]*n,t[3]=r[3]+a[3]*n,t},e.distance=function(t,r){var a=r[0]-t[0],n=r[1]-t[1],e=r[2]-t[2],o=r[3]-t[3];return Math.sqrt(a*a+n*n+e*e+o*o)},e.dist=e.distance,e.squaredDistance=function(t,r){var a=r[0]-t[0],n=r[1]-t[1],e=r[2]-t[2],o=r[3]-t[3];return a*a+n*n+e*e+o*o},e.sqrDist=e.squaredDistance,e.length=function(t){var r=t[0],a=t[1],n=t[2],e=t[3];return Math.sqrt(r*r+a*a+n*n+e*e)},e.len=e.length,e.squaredLength=function(t){var r=t[0],a=t[1],n=t[2],e=t[3];return r*r+a*a+n*n+e*e},e.sqrLen=e.squaredLength,e.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t},e.inverse=function(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t[3]=1/r[3],t},e.normalize=function(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],u=a*a+n*n+e*e+o*o;return u>0&&(u=1/Math.sqrt(u),t[0]=a*u,t[1]=n*u,t[2]=e*u,t[3]=o*u),t},e.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]},e.lerp=function(t,r,a,n){var e=r[0],o=r[1],u=r[2],l=r[3];return t[0]=e+n*(a[0]-e),t[1]=o+n*(a[1]-o),t[2]=u+n*(a[2]-u),t[3]=l+n*(a[3]-l),t},e.random=function(t,r){return r=r||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),e.normalize(t,t),e.scale(t,t,r),t},e.transformMat4=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=r[3];return t[0]=a[0]*n+a[4]*e+a[8]*o+a[12]*u,t[1]=a[1]*n+a[5]*e+a[9]*o+a[13]*u,t[2]=a[2]*n+a[6]*e+a[10]*o+a[14]*u,t[3]=a[3]*n+a[7]*e+a[11]*o+a[15]*u,t},e.transformQuat=function(t,r,a){var n=r[0],e=r[1],o=r[2],u=a[0],l=a[1],i=a[2],c=a[3],s=c*n+l*o-i*e,f=c*e+i*n-u*o,M=c*o+u*e-l*n,m=-u*n-l*e-i*o;return t[0]=s*c+m*-u+f*-i-M*-l,t[1]=f*c+m*-l+M*-u-s*-i,t[2]=M*c+m*-i+s*-l-f*-u,t[3]=r[3],t},e.forEach=function(){var t=e.create();return function(r,a,n,e,o,u){var l,i;for(a||(a=4),n||(n=0),i=e?Math.min(e*a+n,r.length):r.length,l=n;i>l;l+=a)t[0]=r[l],t[1]=r[l+1],t[2]=r[l+2],t[3]=r[l+3],o(t,t,u),r[l]=t[0],r[l+1]=t[1],r[l+2]=t[2],r[l+3]=t[3];return r}}(),e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=e},function(t,r,a){var n=a(1),e={create:function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},clone:function(t){var r=new n.ARRAY_TYPE(2);return r[0]=t[0],r[1]=t[1],r},fromValues:function(t,r){var a=new n.ARRAY_TYPE(2);return a[0]=t,a[1]=r,a},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t},set:function(t,r,a){return t[0]=r,t[1]=a,t},add:function(t,r,a){return t[0]=r[0]+a[0],t[1]=r[1]+a[1],t},subtract:function(t,r,a){return t[0]=r[0]-a[0],t[1]=r[1]-a[1],t}};e.sub=e.subtract,e.multiply=function(t,r,a){return t[0]=r[0]*a[0],t[1]=r[1]*a[1],t},e.mul=e.multiply,e.divide=function(t,r,a){return t[0]=r[0]/a[0],t[1]=r[1]/a[1],t},e.div=e.divide,e.min=function(t,r,a){return t[0]=Math.min(r[0],a[0]),t[1]=Math.min(r[1],a[1]),t},e.max=function(t,r,a){return t[0]=Math.max(r[0],a[0]),t[1]=Math.max(r[1],a[1]),t},e.scale=function(t,r,a){return t[0]=r[0]*a,t[1]=r[1]*a,t},e.scaleAndAdd=function(t,r,a,n){return t[0]=r[0]+a[0]*n,t[1]=r[1]+a[1]*n,t},e.distance=function(t,r){var a=r[0]-t[0],n=r[1]-t[1];return Math.sqrt(a*a+n*n)},e.dist=e.distance,e.squaredDistance=function(t,r){var a=r[0]-t[0],n=r[1]-t[1];return a*a+n*n},e.sqrDist=e.squaredDistance,e.length=function(t){var r=t[0],a=t[1];return Math.sqrt(r*r+a*a)},e.len=e.length,e.squaredLength=function(t){var r=t[0],a=t[1];return r*r+a*a},e.sqrLen=e.squaredLength,e.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t},e.inverse=function(t,r){return t[0]=1/r[0],t[1]=1/r[1],t},e.normalize=function(t,r){var a=r[0],n=r[1],e=a*a+n*n;return e>0&&(e=1/Math.sqrt(e),t[0]=r[0]*e,t[1]=r[1]*e),t},e.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]},e.cross=function(t,r,a){var n=r[0]*a[1]-r[1]*a[0];return t[0]=t[1]=0,t[2]=n,t},e.lerp=function(t,r,a,n){var e=r[0],o=r[1];return t[0]=e+n*(a[0]-e),t[1]=o+n*(a[1]-o),t},e.random=function(t,r){r=r||1;var a=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(a)*r,t[1]=Math.sin(a)*r,t},e.transformMat2=function(t,r,a){var n=r[0],e=r[1];return t[0]=a[0]*n+a[2]*e,t[1]=a[1]*n+a[3]*e,t},e.transformMat2d=function(t,r,a){var n=r[0],e=r[1];return t[0]=a[0]*n+a[2]*e+a[4],t[1]=a[1]*n+a[3]*e+a[5],t},e.transformMat3=function(t,r,a){var n=r[0],e=r[1];return t[0]=a[0]*n+a[3]*e+a[6],t[1]=a[1]*n+a[4]*e+a[7],t},e.transformMat4=function(t,r,a){var n=r[0],e=r[1];return t[0]=a[0]*n+a[4]*e+a[12],t[1]=a[1]*n+a[5]*e+a[13],t},e.forEach=function(){var t=e.create();return function(r,a,n,e,o,u){var l,i;for(a||(a=2),n||(n=0),i=e?Math.min(e*a+n,r.length):r.length,l=n;i>l;l+=a)t[0]=r[l],t[1]=r[l+1],o(t,t,u),r[l]=t[0],r[l+1]=t[1];return r}}(),e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},t.exports=e}])});var t,r,a,n,e=[1,1,1,-1,1,1,1,1,1,1,-1,1,-1,-1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,1,-1,1,1,-1,1,-1,-1,1,-1,-1,1,-1,1,1,-1,-1,-1,-1,-1,1,1,-1,-1,1,-1,-1,1,-1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1];function o(t,r,a,n,e,o,u){for(var l=(a-r)/t,i=(e-n)/t,c=0;c<=t;c++)for(var s=0;s<=t;s++)o.push(r+l*s),o.push(e-i*c),o.push(0);for(c=0;c<t;c++)for(s=0;s<t;s++){var f=c*(t+1)+s;u.push(f),u.push(f+(t+1)),u.push(f+1),u.push(f+1),u.push(f+(t+1)),u.push(f+1+(t+1))}}function u(t,r){for(i=0;i<3;i++)r.push(t[i])}function l(t,r,a,n,e){if(n>0){var o=0,i=vec4.create();vec4.lerp(i,t,r,.5);var c=vec4.create();vec4.lerp(c,t,a,.5);var s=vec4.create();return vec4.lerp(s,r,a,.5),o+=l(t,i,c,n-1,e),o+=l(i,r,s,n-1,e),o+=l(s,a,c,n-1,e),o+=l(i,s,c,n-1,e)}return u(t,e),u(r,e),u(a,e),1}function c(t,r,a,n,e,o){var u=0,i=vec4.fromValues(r,n,0,0),c=vec4.fromValues(a,n,0,0),s=vec4.fromValues(a,e,0,0),f=vec4.fromValues(r,e,0,0);return u+=l(i,c,f,t,o),u+=l(c,s,f,t,o)}function s(t,r,a,n,e,o){if(n>0){var l=0,i=vec4.create();vec4.lerp(i,t,r,.5),vec4.normalize(i,i);var c=vec4.create();vec4.lerp(c,t,a,.5),vec4.normalize(c,c);var f=vec4.create();return vec4.lerp(f,r,a,.5),vec4.normalize(f,f),l+=s(t,i,c,n-1,e,o),l+=s(i,r,f,n-1,e,o),l+=s(f,a,c,n-1,e,o),l+=s(i,f,c,n-1,e,o)}return u(t,e),u(r,e),u(a,e),u(t,o),u(r,o),u(a,o),1}function f(t,r,a){var n=0,e=vec4.fromValues(0,0,-1,0),o=vec4.fromValues(0,.942809,.333333,0),u=vec4.fromValues(-.816497,-.471405,.333333,0),l=vec4.fromValues(.816497,-.471405,.333333,0);return n+=s(e,o,u,t,r,a),n+=s(l,u,o,t,r,a),n+=s(e,l,o,t,r,a),n+=s(e,u,l,t,r,a)}var M,m,S,x=23,D=vec3.fromValues(0,0,150),v=vec3.fromValues(0,0,-1),I=vec3.fromValues(0,1,0),F=vec3.fromValues(0,0,0),h=mat3.create(),d=mat4.create(),p=mat4.create(),w=mat4.create(),A=mat4.create(),g=new Date,z=[],b=vec3.fromValues(0,-9.81,0),R=.001,L=40,y=5,E={},q=quat.create(),P=quat.create(),T=quat.create(),Y=vec3.fromValues(0,1,0),_=vec3.fromValues(1,0,0),U=vec3.fromValues(0,0,-1),C=vec3.fromValues(1,0,0);function V(){var r=new Date,n=(r.getTime()-g.getTime())/1e3;if(g=r,!(n>1)){for(var e=0;e<z.length;e++){var o=z[e],u=vec3.create();vec3.scale(u,o.v,n),vec3.add(o.p,o.p,u);var l=vec3.create();vec3.add(l,l,b);var i=document.getElementById("dragMagnitude").value/10,c=vec3.create();vec3.scale(c,o.v,-1),vec3.normalize(c,c),vec3.scale(c,c,i*R*vec3.sqrLen(o.v)),vec3.add(l,l,c);var s=document.getElementById("extraVel").value/100*5,f=vec3.create();vec3.normalize(f,o.v),vec3.scale(f,f,s),vec3.add(l,l,f);var M=vec3.create();vec3.scale(M,l,n),vec3.add(o.v,o.v,M);for(var m=0;m<3;m++)(o.p[m]<-L+o.r||o.p[m]>L-o.r)&&(o.v[m]=-o.v[m],o.p[m]=o.p[m]<-L+o.r?-L+o.r:L-o.r)}t.viewport(0,0,t.viewportWidth,t.viewportHeight),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),mat4.perspective(A,ot(45),t.viewportWidth/t.viewportHeight,.1,1e3),W(n),vec3.add(F,D,v),mat4.lookAt(p,D,F,I),st([20,20,20],[0,0,0],[1,1,1],[1,1,1]),t.uniform1i(t.getUniformLocation(a,"constColor"),0);for(e=0;e<z.length;e++){o=z[e];d=mat4.create();var S=vec3.fromValues(o.r,o.r,o.r);mat4.translate(d,d,o.p),mat4.scale(d,d,S),mat4.mul(w,p,d),ct(o.c,o.c,[1,1,1],x),et(),$()}t.uniform1i(t.getUniformLocation(a,"constColor"),1),d=mat4.create();S=vec3.fromValues(L,L,L);mat4.scale(d,d,S),mat4.mul(w,p,d),ct([1,1,1],[1,1,1],[1,1,1],x),et(),tt()}}function B(t,r,a,n){z.push({p:vec3.clone(t),v:vec3.clone(r),r:a,c:n})}function N(t){for(var r=0;r<t;r++){var a=vec3.create();vec3.random(a,L);var n=vec3.create();vec3.random(n,L);var e=vec3.create();vec3.random(e,1),vec3.lerp(e,e,[1,1,1],.7),B(n,a,2*Math.random()+1,e)}}function O(){N(5),g=new Date}function W(t){var r=ot(90);vec3.scale(U,v,20*t),vec3.scale(C,_,20*t),E.w&&vec3.add(D,D,U),E.s&&vec3.sub(D,D,U),E.a&&vec3.sub(D,D,C),E.d&&vec3.add(D,D,C);var a=0,n=0;E.arrowleft&&(a+=.8*r*t),E.arrowright&&(a-=.8*r*t),E.arrowup&&(n+=.8*r*t),E.arrowdown&&(n-=.8*r*t),quat.setAxisAngle(q,[0,1,0],a),quat.setAxisAngle(P,_,n),quat.identity(T),quat.mul(T,q,T),quat.mul(T,P,T),vec3.transformQuat(v,v,T),vec3.transformQuat(Y,Y,T),vec3.transformQuat(_,_,T)}function k(){z.length=0}function j(t){var r=t.key.toLowerCase();if(E[r]=!0,"arrowup"!=r&&"arrowleft"!=r&&"arrowright"!=r&&"arrowdown"!=r||t.preventDefault(),"e"==r&&N(5),"r"==r)for(var a=0;a<5;a++)z.pop()}function G(t){E[t.key.toLowerCase()]=!1}function H(t){return parseInt(Z(t).substring(0,2),16)}function Q(t){return parseInt(Z(t).substring(2,4),16)}function X(t){return parseInt(Z(t).substring(4,6),16)}function Z(t){return"#"==t.charAt(0)?t.substring(1,7):t}function K(){var r=[],a=[],n=f(4,r,a);console.log("Generated ",n," triangles"),M=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,M),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW),M.itemSize=3,M.numItems=r.length/3,console.log(r.length/9),m=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,new Float32Array(a),t.STATIC_DRAW),m.itemSize=3,m.numItems=a.length/3,console.log("Normals ",a.length/3)}function J(){S=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,S),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),S.itemSize=3,S.numItems=e.length/3}function $(){t.bindBuffer(t.ARRAY_BUFFER,M),t.vertexAttribPointer(a.vertexPositionAttribute,M.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,m),t.vertexAttribPointer(a.vertexNormalAttribute,m.itemSize,t.FLOAT,!1,0,0),t.drawArrays(t.TRIANGLES,0,M.numItems)}function tt(){t.bindBuffer(t.ARRAY_BUFFER,S),t.vertexAttribPointer(a.vertexPositionAttribute,S.itemSize,t.FLOAT,!1,0,0),t.drawArrays(t.LINES,0,S.numItems)}function rt(){t.uniformMatrix4fv(a.mvMatrixUniform,!1,w)}function at(){t.uniformMatrix4fv(a.pMatrixUniform,!1,A)}function nt(){mat3.fromMat4(h,w),mat3.transpose(h,h),mat3.invert(h,h),t.uniformMatrix3fv(a.nMatrixUniform,!1,h)}function et(){rt(),nt(),at()}function ot(t){return t*Math.PI/180}function ut(t){for(var r=["webgl","experimental-webgl"],a=null,n=0;n<r.length;n++){try{a=t.getContext(r[n])}catch(t){}if(a)break}return a?(a.viewportWidth=t.width,a.viewportHeight=t.height):alert("Failed to create WebGL context!"),a}function lt(r){var a=document.getElementById(r);if(!a)return null;for(var n,e="",o=a.firstChild;o;)3==o.nodeType&&(e+=o.textContent),o=o.nextSibling;if("x-shader/x-fragment"==a.type)n=t.createShader(t.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!=a.type)return null;n=t.createShader(t.VERTEX_SHADER)}return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert(t.getShaderInfoLog(n)),null)}function it(r,n){vertexShader=lt(r),fragmentShader=lt(n),a=t.createProgram(),t.attachShader(a,vertexShader),t.attachShader(a,fragmentShader),t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)||alert("Failed to setup shaders"),t.useProgram(a),a.vertexPositionAttribute=t.getAttribLocation(a,"aVertexPosition"),t.enableVertexAttribArray(a.vertexPositionAttribute),a.vertexNormalAttribute=t.getAttribLocation(a,"aVertexNormal"),t.enableVertexAttribArray(a.vertexNormalAttribute),a.mvMatrixUniform=t.getUniformLocation(a,"uMVMatrix"),a.pMatrixUniform=t.getUniformLocation(a,"uPMatrix"),a.nMatrixUniform=t.getUniformLocation(a,"uNMatrix"),a.uniformLightPositionLoc=t.getUniformLocation(a,"uLightPosition"),a.uniformAmbientLightColorLoc=t.getUniformLocation(a,"uAmbientLightColor"),a.uniformDiffuseLightColorLoc=t.getUniformLocation(a,"uDiffuseLightColor"),a.uniformSpecularLightColorLoc=t.getUniformLocation(a,"uSpecularLightColor"),a.uniformDiffuseMaterialColor=t.getUniformLocation(a,"uDiffuseMaterialColor"),a.uniformAmbientMaterialColor=t.getUniformLocation(a,"uAmbientMaterialColor"),a.uniformSpecularMaterialColor=t.getUniformLocation(a,"uSpecularMaterialColor"),a.uniformShininess=t.getUniformLocation(a,"uShininess")}function ct(r,n,e,o){t.uniform3fv(a.uniformDiffuseMaterialColor,r),t.uniform3fv(a.uniformAmbientMaterialColor,n),t.uniform3fv(a.uniformSpecularMaterialColor,e),t.uniform1f(a.uniformShininess,o)}function st(r,n,e,o){t.uniform3fv(a.uniformLightPositionLoc,r),t.uniform3fv(a.uniformAmbientLightColorLoc,n),t.uniform3fv(a.uniformDiffuseLightColorLoc,e),t.uniform3fv(a.uniformSpecularLightColorLoc,o)}function ft(){K(),J()}function Mt(){r.width=window.innerWidth,r.height=window.innerHeight,t.viewportWidth=r.width,t.viewportHeight=r.height}function startup(){r=document.getElementById("myGLCanvas"),t=ut(r),it("shader-phong-phong-vs","shader-phong-phong-fs"),ft(),t.clearColor(0,0,0,1),t.enable(t.DEPTH_TEST),document.onkeydown=j,document.onkeyup=G,window.addEventListener("resize",Mt,!1),Mt(),O(),mt()}function mt(){requestAnimFrame(mt),V()}