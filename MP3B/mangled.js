!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var a in r)("object"==typeof exports?exports:t)[a]=r[a]}}(this,function(){return function(t){function e(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,a){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=t},e.toRadian=function(t){return t*n},e.equals=function(t,e){return Math.abs(t-e)<=a*Math.max(1,Math.abs(t),Math.abs(e))};var a=e.EPSILON=1e-6,n=(e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,e.RANDOM=Math.random,Math.PI/180)},function(t,e,r){"use strict";function a(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],f=e[6],h=e[7],l=e[8],c=r[0],m=r[1],d=r[2],M=r[3],g=r[4],v=r[5],p=r[6],b=r[7],P=r[8];return t[0]=c*a+m*i+d*f,t[1]=c*n+m*u+d*h,t[2]=c*o+m*s+d*l,t[3]=M*a+g*i+v*f,t[4]=M*n+g*u+v*h,t[5]=M*o+g*s+v*l,t[6]=p*a+b*i+P*f,t[7]=p*n+b*u+P*h,t[8]=p*o+b*s+P*l,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new o.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new o.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,r,a,n,i,u,s,f){var h=new o.ARRAY_TYPE(9);return h[0]=t,h[1]=e,h[2]=r,h[3]=a,h[4]=n,h[5]=i,h[6]=u,h[7]=s,h[8]=f,h},e.set=function(t,e,r,a,n,o,i,u,s,f){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=f,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var r=e[1],a=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=a,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],f=e[7],h=e[8],l=h*i-u*f,c=-h*o+u*s,m=f*o-i*s,d=r*l+a*c+n*m;return d?(d=1/d,t[0]=l*d,t[1]=(-h*a+n*f)*d,t[2]=(u*a-n*i)*d,t[3]=c*d,t[4]=(h*r-n*s)*d,t[5]=(-u*r+n*o)*d,t[6]=m*d,t[7]=(-f*r+a*s)*d,t[8]=(i*r-a*o)*d,t):null},e.adjoint=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],f=e[7],h=e[8];return t[0]=i*h-u*f,t[1]=n*f-a*h,t[2]=a*u-n*i,t[3]=u*s-o*h,t[4]=r*h-n*s,t[5]=n*o-r*u,t[6]=o*f-i*s,t[7]=a*s-r*f,t[8]=r*i-a*o,t},e.determinant=function(t){var e=t[0],r=t[1],a=t[2],n=t[3],o=t[4],i=t[5],u=t[6],s=t[7],f=t[8];return e*(f*o-i*s)+r*(-f*n+i*u)+a*(s*n-o*u)},e.multiply=a,e.translate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],f=e[6],h=e[7],l=e[8],c=r[0],m=r[1];return t[0]=a,t[1]=n,t[2]=o,t[3]=i,t[4]=u,t[5]=s,t[6]=c*a+m*i+f,t[7]=c*n+m*u+h,t[8]=c*o+m*s+l,t},e.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],f=e[6],h=e[7],l=e[8],c=Math.sin(r),m=Math.cos(r);return t[0]=m*a+c*i,t[1]=m*n+c*u,t[2]=m*o+c*s,t[3]=m*i-c*a,t[4]=m*u-c*n,t[5]=m*s-c*o,t[6]=f,t[7]=h,t[8]=l,t},e.scale=function(t,e,r){var a=r[0],n=r[1];return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=0,t[3]=-r,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r+r,u=a+a,s=n+n,f=r*i,h=a*i,l=a*u,c=n*i,m=n*u,d=n*s,M=o*i,g=o*u,v=o*s;return t[0]=1-l-d,t[3]=h-v,t[6]=c+g,t[1]=h+v,t[4]=1-f-d,t[7]=m-M,t[2]=c-g,t[5]=m+M,t[8]=1-f-l,t},e.normalFromMat4=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],f=e[7],h=e[8],l=e[9],c=e[10],m=e[11],d=e[12],M=e[13],g=e[14],v=e[15],p=r*u-a*i,b=r*s-n*i,P=r*f-o*i,x=a*s-n*u,E=a*f-o*u,A=n*f-o*s,R=h*M-l*d,y=h*g-c*d,w=h*v-m*d,T=l*g-c*M,S=l*v-m*M,B=c*v-m*g,L=p*B-b*S+P*T+x*w-E*y+A*R;return L?(L=1/L,t[0]=(u*B-s*S+f*T)*L,t[1]=(s*w-i*B-f*y)*L,t[2]=(i*S-u*w+f*R)*L,t[3]=(n*S-a*B-o*T)*L,t[4]=(r*B-n*w+o*y)*L,t[5]=(a*w-r*S-o*R)*L,t[6]=(M*A-g*E+v*x)*L,t[7]=(g*P-d*A-v*b)*L,t[8]=(d*E-M*P+v*p)*L,t):null},e.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},e.multiplyScalarAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t[4]=e[4]+r[4]*a,t[5]=e[5]+r[5]*a,t[6]=e[6]+r[6]*a,t[7]=e[7]+r[7]*a,t[8]=e[8]+r[8]*a,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var r=t[0],a=t[1],n=t[2],i=t[3],u=t[4],s=t[5],f=t[6],h=t[7],l=t[8],c=e[0],m=e[1],d=e[2],M=e[3],g=e[4],v=e[5],p=e[6],b=e[7],P=e[8];return Math.abs(r-c)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(a-m)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(n-d)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-M)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(u-g)<=o.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(s-v)<=o.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(f-p)<=o.EPSILON*Math.max(1,Math.abs(f),Math.abs(p))&&Math.abs(h-b)<=o.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(l-P)<=o.EPSILON*Math.max(1,Math.abs(l),Math.abs(P))};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.mul=a,e.sub=n},function(t,e,r){"use strict";function a(){var t=new d.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function n(t){var e=t[0],r=t[1],a=t[2];return Math.sqrt(e*e+r*r+a*a)}function o(t,e,r){var a=new d.ARRAY_TYPE(3);return a[0]=t,a[1]=e,a[2]=r,a}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function u(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function s(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function f(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+a*a+n*n)}function h(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2];return r*r+a*a+n*n}function l(t){var e=t[0],r=t[1],a=t[2];return e*e+r*r+a*a}function c(t,e){var r=e[0],a=e[1],n=e[2],o=r*r+a*a+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function m(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=a,e.clone=function(t){var e=new d.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=n,e.fromValues=o,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,r,a){return t[0]=e,t[1]=r,t[2]=a,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},e.subtract=i,e.multiply=u,e.divide=s,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},e.scaleAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t},e.distance=f,e.squaredDistance=h,e.squaredLength=l,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=c,e.dot=m,e.cross=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],u=r[1],s=r[2];return t[0]=n*s-o*u,t[1]=o*i-a*s,t[2]=a*u-n*i,t},e.lerp=function(t,e,r,a){var n=e[0],o=e[1],i=e[2];return t[0]=n+a*(r[0]-n),t[1]=o+a*(r[1]-o),t[2]=i+a*(r[2]-i),t},e.hermite=function(t,e,r,a,n,o){var i=o*o,u=i*(2*o-3)+1,s=i*(o-2)+o,f=i*(o-1),h=i*(3-2*o);return t[0]=e[0]*u+r[0]*s+a[0]*f+n[0]*h,t[1]=e[1]*u+r[1]*s+a[1]*f+n[1]*h,t[2]=e[2]*u+r[2]*s+a[2]*f+n[2]*h,t},e.bezier=function(t,e,r,a,n,o){var i=1-o,u=i*i,s=o*o,f=u*i,h=3*o*u,l=3*s*i,c=s*o;return t[0]=e[0]*f+r[0]*h+a[0]*l+n[0]*c,t[1]=e[1]*f+r[1]*h+a[1]*l+n[1]*c,t[2]=e[2]*f+r[2]*h+a[2]*l+n[2]*c,t},e.random=function(t,e){e=e||1;var r=2*d.RANDOM()*Math.PI,a=2*d.RANDOM()-1,n=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t[2]=a*e,t},e.transformMat4=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[3]*a+r[7]*n+r[11]*o+r[15];return i=i||1,t[0]=(r[0]*a+r[4]*n+r[8]*o+r[12])/i,t[1]=(r[1]*a+r[5]*n+r[9]*o+r[13])/i,t[2]=(r[2]*a+r[6]*n+r[10]*o+r[14])/i,t},e.transformMat3=function(t,e,r){var a=e[0],n=e[1],o=e[2];return t[0]=a*r[0]+n*r[3]+o*r[6],t[1]=a*r[1]+n*r[4]+o*r[7],t[2]=a*r[2]+n*r[5]+o*r[8],t},e.transformQuat=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],u=r[1],s=r[2],f=r[3],h=f*a+u*o-s*n,l=f*n+s*a-i*o,c=f*o+i*n-u*a,m=-i*a-u*n-s*o;return t[0]=h*f+m*-i+l*-s-c*-u,t[1]=l*f+m*-u+c*-i-h*-s,t[2]=c*f+m*-s+h*-u-l*-i,t},e.rotateX=function(t,e,r,a){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0],o[1]=n[1]*Math.cos(a)-n[2]*Math.sin(a),o[2]=n[1]*Math.sin(a)+n[2]*Math.cos(a),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},e.rotateY=function(t,e,r,a){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[2]*Math.sin(a)+n[0]*Math.cos(a),o[1]=n[1],o[2]=n[2]*Math.cos(a)-n[0]*Math.sin(a),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},e.rotateZ=function(t,e,r,a){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0]*Math.cos(a)-n[1]*Math.sin(a),o[1]=n[0]*Math.sin(a)+n[1]*Math.cos(a),o[2]=n[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},e.angle=function(t,e){var r=o(t[0],t[1],t[2]),a=o(e[0],e[1],e[2]);c(r,r),c(a,a);var n=m(r,a);return n>1?0:n<-1?Math.PI:Math.acos(n)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var r=t[0],a=t[1],n=t[2],o=e[0],i=e[1],u=e[2];return Math.abs(r-o)<=d.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-i)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(n-u)<=d.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))};var d=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.sub=i,e.mul=u,e.div=s,e.dist=f,e.sqrDist=h,e.len=n,e.sqrLen=l,e.forEach=function(){var t=a();return function(e,r,a,n,o,i){var u,s=void 0;for(r||(r=3),a||(a=0),u=n?Math.min(n*r+a,e.length):e.length,s=a;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,i),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}()},function(t,e,r){"use strict";function a(){var t=new m.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function o(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function i(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function u(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function s(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+a*a+n*n+o*o)}function f(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return r*r+a*a+n*n+o*o}function h(t){var e=t[0],r=t[1],a=t[2],n=t[3];return Math.sqrt(e*e+r*r+a*a+n*n)}function l(t){var e=t[0],r=t[1],a=t[2],n=t[3];return e*e+r*r+a*a+n*n}function c(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r*r+a*a+n*n+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=r*i,t[1]=a*i,t[2]=n*i,t[3]=o*i),t}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=a,e.clone=function(t){var e=new m.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,r,a){var n=new m.ARRAY_TYPE(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=a,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,r,a,n){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=n,e.multiply=o,e.divide=i,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=u,e.scaleAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t},e.distance=s,e.squaredDistance=f,e.length=h,e.squaredLength=l,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=c,e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,r,a){var n=e[0],o=e[1],i=e[2],u=e[3];return t[0]=n+a*(r[0]-n),t[1]=o+a*(r[1]-o),t[2]=i+a*(r[2]-i),t[3]=u+a*(r[3]-u),t},e.random=function(t,e){return e=e||1,t[0]=m.RANDOM(),t[1]=m.RANDOM(),t[2]=m.RANDOM(),t[3]=m.RANDOM(),c(t,t),u(t,t,e),t},e.transformMat4=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3];return t[0]=r[0]*a+r[4]*n+r[8]*o+r[12]*i,t[1]=r[1]*a+r[5]*n+r[9]*o+r[13]*i,t[2]=r[2]*a+r[6]*n+r[10]*o+r[14]*i,t[3]=r[3]*a+r[7]*n+r[11]*o+r[15]*i,t},e.transformQuat=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],u=r[1],s=r[2],f=r[3],h=f*a+u*o-s*n,l=f*n+s*a-i*o,c=f*o+i*n-u*a,m=-i*a-u*n-s*o;return t[0]=h*f+m*-i+l*-s-c*-u,t[1]=l*f+m*-u+c*-i-h*-s,t[2]=c*f+m*-s+h*-u-l*-i,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],a=t[1],n=t[2],o=t[3],i=e[0],u=e[1],s=e[2],f=e[3];return Math.abs(r-i)<=m.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-u)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(n-s)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-f)<=m.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))};var m=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.sub=n,e.mul=o,e.div=i,e.dist=s,e.sqrDist=f,e.len=h,e.sqrLen=l,e.forEach=function(){var t=a();return function(e,r,a,n,o,i){var u,s=void 0;for(r||(r=4),a||(a=0),u=n?Math.min(n*r+a,e.length):e.length,s=a;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,i),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}()},function(t,e,r){"use strict";function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var n=a(r(0)),o=a(r(5)),i=a(r(6)),u=a(r(1)),s=a(r(7)),f=a(r(8)),h=a(r(9)),l=a(r(2)),c=a(r(3));e.glMatrix=n,e.mat2=o,e.mat2d=i,e.mat3=u,e.mat4=s,e.quat=f,e.vec2=h,e.vec3=l,e.vec4=c},function(t,e,r){"use strict";function a(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=r[0],s=r[1],f=r[2],h=r[3];return t[0]=a*u+o*s,t[1]=n*u+i*s,t[2]=a*f+o*h,t[3]=n*f+i*h,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new o.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var e=new o.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,r,a){var n=new o.ARRAY_TYPE(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=a,n},e.set=function(t,e,r,a,n){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t},e.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r*o-n*a;return i?(i=1/i,t[0]=o*i,t[1]=-a*i,t[2]=-n*i,t[3]=r*i,t):null},e.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=a,e.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=a*s+o*u,t[1]=n*s+i*u,t[2]=a*-u+o*s,t[3]=n*-u+i*s,t},e.scale=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=r[0],s=r[1];return t[0]=a*u,t[1]=n*u,t[2]=o*s,t[3]=i*s,t},e.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=-r,t[3]=a,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,r,a){return t[2]=a[2]/a[0],r[0]=a[0],r[1]=a[1],r[3]=a[3]-t[2]*r[1],[t,e,r]},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=n,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],a=t[1],n=t[2],i=t[3],u=e[0],s=e[1],f=e[2],h=e[3];return Math.abs(r-u)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-s)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(n-f)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-h)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))},e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},e.multiplyScalarAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.mul=a,e.sub=n},function(t,e,r){"use strict";function a(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],f=r[0],h=r[1],l=r[2],c=r[3],m=r[4],d=r[5];return t[0]=a*f+o*h,t[1]=n*f+i*h,t[2]=a*l+o*c,t[3]=n*l+i*c,t[4]=a*m+o*d+u,t[5]=n*m+i*d+s,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new o.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.clone=function(t){var e=new o.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,r,a,n,i){var u=new o.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=r,u[3]=a,u[4]=n,u[5]=i,u},e.set=function(t,e,r,a,n,o,i){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t[4]=o,t[5]=i,t},e.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=r*o-a*n;return s?(s=1/s,t[0]=o*s,t[1]=-a*s,t[2]=-n*s,t[3]=r*s,t[4]=(n*u-o*i)*s,t[5]=(a*i-r*u)*s,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=a,e.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],f=Math.sin(r),h=Math.cos(r);return t[0]=a*h+o*f,t[1]=n*h+i*f,t[2]=a*-f+o*h,t[3]=n*-f+i*h,t[4]=u,t[5]=s,t},e.scale=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],f=r[0],h=r[1];return t[0]=a*f,t[1]=n*f,t[2]=o*h,t[3]=i*h,t[4]=u,t[5]=s,t},e.translate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],f=r[0],h=r[1];return t[0]=a,t[1]=n,t[2]=o,t[3]=i,t[4]=a*f+o*h+u,t[5]=n*f+i*h+s,t},e.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=-r,t[3]=a,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},e.multiplyScalarAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t[4]=e[4]+r[4]*a,t[5]=e[5]+r[5]*a,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var r=t[0],a=t[1],n=t[2],i=t[3],u=t[4],s=t[5],f=e[0],h=e[1],l=e[2],c=e[3],m=e[4],d=e[5];return Math.abs(r-f)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(a-h)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(n-l)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-c)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(u-m)<=o.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(s-d)<=o.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.mul=a,e.sub=n},function(t,e,r){"use strict";function a(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],f=e[6],h=e[7],l=e[8],c=e[9],m=e[10],d=e[11],M=e[12],g=e[13],v=e[14],p=e[15],b=r[0],P=r[1],x=r[2],E=r[3];return t[0]=b*a+P*u+x*l+E*M,t[1]=b*n+P*s+x*c+E*g,t[2]=b*o+P*f+x*m+E*v,t[3]=b*i+P*h+x*d+E*p,b=r[4],P=r[5],x=r[6],E=r[7],t[4]=b*a+P*u+x*l+E*M,t[5]=b*n+P*s+x*c+E*g,t[6]=b*o+P*f+x*m+E*v,t[7]=b*i+P*h+x*d+E*p,b=r[8],P=r[9],x=r[10],E=r[11],t[8]=b*a+P*u+x*l+E*M,t[9]=b*n+P*s+x*c+E*g,t[10]=b*o+P*f+x*m+E*v,t[11]=b*i+P*h+x*d+E*p,b=r[12],P=r[13],x=r[14],E=r[15],t[12]=b*a+P*u+x*l+E*M,t[13]=b*n+P*s+x*c+E*g,t[14]=b*o+P*f+x*m+E*v,t[15]=b*i+P*h+x*d+E*p,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new o.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var e=new o.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,r,a,n,i,u,s,f,h,l,c,m,d,M,g){var v=new o.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=r,v[3]=a,v[4]=n,v[5]=i,v[6]=u,v[7]=s,v[8]=f,v[9]=h,v[10]=l,v[11]=c,v[12]=m,v[13]=d,v[14]=M,v[15]=g,v},e.set=function(t,e,r,a,n,o,i,u,s,f,h,l,c,m,d,M,g){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=f,t[9]=h,t[10]=l,t[11]=c,t[12]=m,t[13]=d,t[14]=M,t[15]=g,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.transpose=function(t,e){if(t===e){var r=e[1],a=e[2],n=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=o,t[11]=e[14],t[12]=n,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],f=e[7],h=e[8],l=e[9],c=e[10],m=e[11],d=e[12],M=e[13],g=e[14],v=e[15],p=r*u-a*i,b=r*s-n*i,P=r*f-o*i,x=a*s-n*u,E=a*f-o*u,A=n*f-o*s,R=h*M-l*d,y=h*g-c*d,w=h*v-m*d,T=l*g-c*M,S=l*v-m*M,B=c*v-m*g,L=p*B-b*S+P*T+x*w-E*y+A*R;return L?(L=1/L,t[0]=(u*B-s*S+f*T)*L,t[1]=(n*S-a*B-o*T)*L,t[2]=(M*A-g*E+v*x)*L,t[3]=(c*E-l*A-m*x)*L,t[4]=(s*w-i*B-f*y)*L,t[5]=(r*B-n*w+o*y)*L,t[6]=(g*P-d*A-v*b)*L,t[7]=(h*A-c*P+m*b)*L,t[8]=(i*S-u*w+f*R)*L,t[9]=(a*w-r*S-o*R)*L,t[10]=(d*E-M*P+v*p)*L,t[11]=(l*P-h*E-m*p)*L,t[12]=(u*y-i*T-s*R)*L,t[13]=(r*T-a*y+n*R)*L,t[14]=(M*b-d*x-g*p)*L,t[15]=(h*x-l*b+c*p)*L,t):null},e.adjoint=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],f=e[7],h=e[8],l=e[9],c=e[10],m=e[11],d=e[12],M=e[13],g=e[14],v=e[15];return t[0]=u*(c*v-m*g)-l*(s*v-f*g)+M*(s*m-f*c),t[1]=-(a*(c*v-m*g)-l*(n*v-o*g)+M*(n*m-o*c)),t[2]=a*(s*v-f*g)-u*(n*v-o*g)+M*(n*f-o*s),t[3]=-(a*(s*m-f*c)-u*(n*m-o*c)+l*(n*f-o*s)),t[4]=-(i*(c*v-m*g)-h*(s*v-f*g)+d*(s*m-f*c)),t[5]=r*(c*v-m*g)-h*(n*v-o*g)+d*(n*m-o*c),t[6]=-(r*(s*v-f*g)-i*(n*v-o*g)+d*(n*f-o*s)),t[7]=r*(s*m-f*c)-i*(n*m-o*c)+h*(n*f-o*s),t[8]=i*(l*v-m*M)-h*(u*v-f*M)+d*(u*m-f*l),t[9]=-(r*(l*v-m*M)-h*(a*v-o*M)+d*(a*m-o*l)),t[10]=r*(u*v-f*M)-i*(a*v-o*M)+d*(a*f-o*u),t[11]=-(r*(u*m-f*l)-i*(a*m-o*l)+h*(a*f-o*u)),t[12]=-(i*(l*g-c*M)-h*(u*g-s*M)+d*(u*c-s*l)),t[13]=r*(l*g-c*M)-h*(a*g-n*M)+d*(a*c-n*l),t[14]=-(r*(u*g-s*M)-i*(a*g-n*M)+d*(a*s-n*u)),t[15]=r*(u*c-s*l)-i*(a*c-n*l)+h*(a*s-n*u),t},e.determinant=function(t){var e=t[0],r=t[1],a=t[2],n=t[3],o=t[4],i=t[5],u=t[6],s=t[7],f=t[8],h=t[9],l=t[10],c=t[11],m=t[12],d=t[13],M=t[14],g=t[15];return(e*i-r*o)*(l*g-c*M)-(e*u-a*o)*(h*g-c*d)+(e*s-n*o)*(h*M-l*d)+(r*u-a*i)*(f*g-c*m)-(r*s-n*i)*(f*M-l*m)+(a*s-n*u)*(f*d-h*m)},e.multiply=a,e.translate=function(t,e,r){var a=r[0],n=r[1],o=r[2],i=void 0,u=void 0,s=void 0,f=void 0,h=void 0,l=void 0,c=void 0,m=void 0,d=void 0,M=void 0,g=void 0,v=void 0;return e===t?(t[12]=e[0]*a+e[4]*n+e[8]*o+e[12],t[13]=e[1]*a+e[5]*n+e[9]*o+e[13],t[14]=e[2]*a+e[6]*n+e[10]*o+e[14],t[15]=e[3]*a+e[7]*n+e[11]*o+e[15]):(i=e[0],u=e[1],s=e[2],f=e[3],h=e[4],l=e[5],c=e[6],m=e[7],d=e[8],M=e[9],g=e[10],v=e[11],t[0]=i,t[1]=u,t[2]=s,t[3]=f,t[4]=h,t[5]=l,t[6]=c,t[7]=m,t[8]=d,t[9]=M,t[10]=g,t[11]=v,t[12]=i*a+h*n+d*o+e[12],t[13]=u*a+l*n+M*o+e[13],t[14]=s*a+c*n+g*o+e[14],t[15]=f*a+m*n+v*o+e[15]),t},e.scale=function(t,e,r){var a=r[0],n=r[1],o=r[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,r,a){var n=a[0],i=a[1],u=a[2],s=Math.sqrt(n*n+i*i+u*u),f=void 0,h=void 0,l=void 0,c=void 0,m=void 0,d=void 0,M=void 0,g=void 0,v=void 0,p=void 0,b=void 0,P=void 0,x=void 0,E=void 0,A=void 0,R=void 0,y=void 0,w=void 0,T=void 0,S=void 0,B=void 0,L=void 0,_=void 0,I=void 0;return Math.abs(s)<o.EPSILON?null:(n*=s=1/s,i*=s,u*=s,f=Math.sin(r),l=1-(h=Math.cos(r)),c=e[0],m=e[1],d=e[2],M=e[3],g=e[4],v=e[5],p=e[6],b=e[7],P=e[8],x=e[9],E=e[10],A=e[11],R=n*n*l+h,y=i*n*l+u*f,w=u*n*l-i*f,T=n*i*l-u*f,S=i*i*l+h,B=u*i*l+n*f,L=n*u*l+i*f,_=i*u*l-n*f,I=u*u*l+h,t[0]=c*R+g*y+P*w,t[1]=m*R+v*y+x*w,t[2]=d*R+p*y+E*w,t[3]=M*R+b*y+A*w,t[4]=c*T+g*S+P*B,t[5]=m*T+v*S+x*B,t[6]=d*T+p*S+E*B,t[7]=M*T+b*S+A*B,t[8]=c*L+g*_+P*I,t[9]=m*L+v*_+x*I,t[10]=d*L+p*_+E*I,t[11]=M*L+b*_+A*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[4],i=e[5],u=e[6],s=e[7],f=e[8],h=e[9],l=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+f*a,t[5]=i*n+h*a,t[6]=u*n+l*a,t[7]=s*n+c*a,t[8]=f*n-o*a,t[9]=h*n-i*a,t[10]=l*n-u*a,t[11]=c*n-s*a,t},e.rotateY=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[0],i=e[1],u=e[2],s=e[3],f=e[8],h=e[9],l=e[10],c=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-f*a,t[1]=i*n-h*a,t[2]=u*n-l*a,t[3]=s*n-c*a,t[8]=o*a+f*n,t[9]=i*a+h*n,t[10]=u*a+l*n,t[11]=s*a+c*n,t},e.rotateZ=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[0],i=e[1],u=e[2],s=e[3],f=e[4],h=e[5],l=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+f*a,t[1]=i*n+h*a,t[2]=u*n+l*a,t[3]=s*n+c*a,t[4]=f*n-o*a,t[5]=h*n-i*a,t[6]=l*n-u*a,t[7]=c*n-s*a,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,r){var a=r[0],n=r[1],i=r[2],u=Math.sqrt(a*a+n*n+i*i),s=void 0,f=void 0,h=void 0;return Math.abs(u)<o.EPSILON?null:(a*=u=1/u,n*=u,i*=u,s=Math.sin(e),h=1-(f=Math.cos(e)),t[0]=a*a*h+f,t[1]=n*a*h+i*s,t[2]=i*a*h-n*s,t[3]=0,t[4]=a*n*h-i*s,t[5]=n*n*h+f,t[6]=i*n*h+a*s,t[7]=0,t[8]=a*i*h+n*s,t[9]=n*i*h-a*s,t[10]=i*i*h+f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=a+a,s=n+n,f=o+o,h=a*u,l=a*s,c=a*f,m=n*s,d=n*f,M=o*f,g=i*u,v=i*s,p=i*f;return t[0]=1-(m+M),t[1]=l+p,t[2]=c-v,t[3]=0,t[4]=l-p,t[5]=1-(h+M),t[6]=d+g,t[7]=0,t[8]=c+v,t[9]=d-g,t[10]=1-(h+m),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[4],i=e[5],u=e[6],s=e[8],f=e[9],h=e[10];return t[0]=Math.sqrt(r*r+a*a+n*n),t[1]=Math.sqrt(o*o+i*i+u*u),t[2]=Math.sqrt(s*s+f*f+h*h),t},e.getRotation=function(t,e){var r=e[0]+e[5]+e[10],a=0;return r>0?(a=2*Math.sqrt(r+1),t[3]=.25*a,t[0]=(e[6]-e[9])/a,t[1]=(e[8]-e[2])/a,t[2]=(e[1]-e[4])/a):e[0]>e[5]&e[0]>e[10]?(a=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/a,t[0]=.25*a,t[1]=(e[1]+e[4])/a,t[2]=(e[8]+e[2])/a):e[5]>e[10]?(a=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/a,t[0]=(e[1]+e[4])/a,t[1]=.25*a,t[2]=(e[6]+e[9])/a):(a=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/a,t[0]=(e[8]+e[2])/a,t[1]=(e[6]+e[9])/a,t[2]=.25*a),t},e.fromRotationTranslationScale=function(t,e,r,a){var n=e[0],o=e[1],i=e[2],u=e[3],s=n+n,f=o+o,h=i+i,l=n*s,c=n*f,m=n*h,d=o*f,M=o*h,g=i*h,v=u*s,p=u*f,b=u*h,P=a[0],x=a[1],E=a[2];return t[0]=(1-(d+g))*P,t[1]=(c+b)*P,t[2]=(m-p)*P,t[3]=0,t[4]=(c-b)*x,t[5]=(1-(l+g))*x,t[6]=(M+v)*x,t[7]=0,t[8]=(m+p)*E,t[9]=(M-v)*E,t[10]=(1-(l+d))*E,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,r,a,n){var o=e[0],i=e[1],u=e[2],s=e[3],f=o+o,h=i+i,l=u+u,c=o*f,m=o*h,d=o*l,M=i*h,g=i*l,v=u*l,p=s*f,b=s*h,P=s*l,x=a[0],E=a[1],A=a[2],R=n[0],y=n[1],w=n[2];return t[0]=(1-(M+v))*x,t[1]=(m+P)*x,t[2]=(d-b)*x,t[3]=0,t[4]=(m-P)*E,t[5]=(1-(c+v))*E,t[6]=(g+p)*E,t[7]=0,t[8]=(d+b)*A,t[9]=(g-p)*A,t[10]=(1-(c+M))*A,t[11]=0,t[12]=r[0]+R-(t[0]*R+t[4]*y+t[8]*w),t[13]=r[1]+y-(t[1]*R+t[5]*y+t[9]*w),t[14]=r[2]+w-(t[2]*R+t[6]*y+t[10]*w),t[15]=1,t},e.fromQuat=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r+r,u=a+a,s=n+n,f=r*i,h=a*i,l=a*u,c=n*i,m=n*u,d=n*s,M=o*i,g=o*u,v=o*s;return t[0]=1-l-d,t[1]=h+v,t[2]=c-g,t[3]=0,t[4]=h-v,t[5]=1-f-d,t[6]=m+M,t[7]=0,t[8]=c+g,t[9]=m-M,t[10]=1-f-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,r,a,n,o,i){var u=1/(r-e),s=1/(n-a),f=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(n+a)*s,t[10]=(i+o)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*f,t[15]=0,t},e.perspective=function(t,e,r,a,n){var o=1/Math.tan(e/2),i=1/(a-n);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+a)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*a*i,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,e,r,a){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(i+u),f=2/(n+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=-(i-u)*s*.5,t[9]=(n-o)*f*.5,t[10]=a/(r-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*r/(r-a),t[15]=0,t},e.ortho=function(t,e,r,a,n,o,i){var u=1/(e-r),s=1/(a-n),f=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+r)*u,t[13]=(n+a)*s,t[14]=(i+o)*f,t[15]=1,t},e.lookAt=function(t,e,r,a){var n=void 0,i=void 0,u=void 0,s=void 0,f=void 0,h=void 0,l=void 0,c=void 0,m=void 0,d=void 0,M=e[0],g=e[1],v=e[2],p=a[0],b=a[1],P=a[2],x=r[0],E=r[1],A=r[2];return Math.abs(M-x)<o.EPSILON&&Math.abs(g-E)<o.EPSILON&&Math.abs(v-A)<o.EPSILON?mat4.identity(t):(l=M-x,c=g-E,m=v-A,n=b*(m*=d=1/Math.sqrt(l*l+c*c+m*m))-P*(c*=d),i=P*(l*=d)-p*m,u=p*c-b*l,(d=Math.sqrt(n*n+i*i+u*u))?(n*=d=1/d,i*=d,u*=d):(n=0,i=0,u=0),s=c*u-m*i,f=m*n-l*u,h=l*i-c*n,(d=Math.sqrt(s*s+f*f+h*h))?(s*=d=1/d,f*=d,h*=d):(s=0,f=0,h=0),t[0]=n,t[1]=s,t[2]=l,t[3]=0,t[4]=i,t[5]=f,t[6]=c,t[7]=0,t[8]=u,t[9]=h,t[10]=m,t[11]=0,t[12]=-(n*M+i*g+u*v),t[13]=-(s*M+f*g+h*v),t[14]=-(l*M+c*g+m*v),t[15]=1,t)},e.targetTo=function(t,e,r,a){var n=e[0],o=e[1],i=e[2],u=a[0],s=a[1],f=a[2],h=n-r[0],l=o-r[1],c=i-r[2],m=h*h+l*l+c*c;m>0&&(h*=m=1/Math.sqrt(m),l*=m,c*=m);var d=s*c-f*l,M=f*h-u*c,g=u*l-s*h;return t[0]=d,t[1]=M,t[2]=g,t[3]=0,t[4]=l*g-c*M,t[5]=c*d-h*g,t[6]=h*M-l*d,t[7]=0,t[8]=h,t[9]=l,t[10]=c,t[11]=0,t[12]=n,t[13]=o,t[14]=i,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},e.subtract=n,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},e.multiplyScalarAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t[4]=e[4]+r[4]*a,t[5]=e[5]+r[5]*a,t[6]=e[6]+r[6]*a,t[7]=e[7]+r[7]*a,t[8]=e[8]+r[8]*a,t[9]=e[9]+r[9]*a,t[10]=e[10]+r[10]*a,t[11]=e[11]+r[11]*a,t[12]=e[12]+r[12]*a,t[13]=e[13]+r[13]*a,t[14]=e[14]+r[14]*a,t[15]=e[15]+r[15]*a,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var r=t[0],a=t[1],n=t[2],i=t[3],u=t[4],s=t[5],f=t[6],h=t[7],l=t[8],c=t[9],m=t[10],d=t[11],M=t[12],g=t[13],v=t[14],p=t[15],b=e[0],P=e[1],x=e[2],E=e[3],A=e[4],R=e[5],y=e[6],w=e[7],T=e[8],S=e[9],B=e[10],L=e[11],_=e[12],I=e[13],O=e[14],N=e[15];return Math.abs(r-b)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(a-P)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(P))&&Math.abs(n-x)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(i-E)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(u-A)<=o.EPSILON*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(s-R)<=o.EPSILON*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(f-y)<=o.EPSILON*Math.max(1,Math.abs(f),Math.abs(y))&&Math.abs(h-w)<=o.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(l-T)<=o.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-S)<=o.EPSILON*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(m-B)<=o.EPSILON*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(d-L)<=o.EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(M-_)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(_))&&Math.abs(g-I)<=o.EPSILON*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(v-O)<=o.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(p-N)<=o.EPSILON*Math.max(1,Math.abs(p),Math.abs(N))};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.mul=a,e.sub=n},function(t,e,r){"use strict";function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function n(){var t=new f.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function o(t,e,r){r*=.5;var a=Math.sin(r);return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=Math.cos(r),t}function i(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=r[0],s=r[1],f=r[2],h=r[3];return t[0]=a*h+i*u+n*f-o*s,t[1]=n*h+i*s+o*u-a*f,t[2]=o*h+i*f+a*s-n*u,t[3]=i*h-a*u-n*s-o*f,t}function u(t,e,r,a){var n=e[0],o=e[1],i=e[2],u=e[3],s=r[0],f=r[1],h=r[2],l=r[3],c=void 0,m=void 0,d=void 0,M=void 0,g=void 0;return(m=n*s+o*f+i*h+u*l)<0&&(m=-m,s=-s,f=-f,h=-h,l=-l),1-m>1e-6?(c=Math.acos(m),d=Math.sin(c),M=Math.sin((1-a)*c)/d,g=Math.sin(a*c)/d):(M=1-a,g=a),t[0]=M*n+g*s,t[1]=M*o+g*f,t[2]=M*i+g*h,t[3]=M*u+g*l,t}function s(t,e){var r=e[0]+e[4]+e[8],a=void 0;if(r>0)a=Math.sqrt(r+1),t[3]=.5*a,a=.5/a,t[0]=(e[5]-e[7])*a,t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);var o=(n+1)%3,i=(n+2)%3;a=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*i+i]+1),t[n]=.5*a,a=.5/a,t[3]=(e[3*o+i]-e[3*i+o])*a,t[o]=(e[3*o+n]+e[3*n+o])*a,t[i]=(e[3*i+n]+e[3*n+i])*a}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=n,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=o,e.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),a=Math.sin(r/2);return 0!=a?(t[0]=e[0]/a,t[1]=e[1]/a,t[2]=e[2]/a):(t[0]=1,t[1]=0,t[2]=0),r},e.multiply=i,e.rotateX=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=a*s+i*u,t[1]=n*s+o*u,t[2]=o*s-n*u,t[3]=i*s-a*u,t},e.rotateY=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=a*s-o*u,t[1]=n*s+i*u,t[2]=o*s+a*u,t[3]=i*s-n*u,t},e.rotateZ=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=a*s+n*u,t[1]=n*s-a*u,t[2]=o*s+i*u,t[3]=i*s-o*u,t},e.calculateW=function(t,e){var r=e[0],a=e[1],n=e[2];return t[0]=r,t[1]=a,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-a*a-n*n)),t},e.slerp=u,e.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r*r+a*a+n*n+o*o,u=i?1/i:0;return t[0]=-r*u,t[1]=-a*u,t[2]=-n*u,t[3]=o*u,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=s,e.fromEuler=function(t,e,r,a){var n=.5*Math.PI/180;e*=n,r*=n,a*=n;var o=Math.sin(e),i=Math.cos(e),u=Math.sin(r),s=Math.cos(r),f=Math.sin(a),h=Math.cos(a);return t[0]=o*s*h-i*u*f,t[1]=i*u*h+o*s*f,t[2]=i*s*f-o*u*h,t[3]=i*s*h+o*u*f,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var f=a(r(0)),h=a(r(1)),l=a(r(2)),c=a(r(3)),m=(e.clone=c.clone,e.fromValues=c.fromValues,e.copy=c.copy,e.set=c.set,e.add=c.add,e.mul=i,e.scale=c.scale,e.dot=c.dot,e.lerp=c.lerp,e.length=c.length),d=(e.len=m,e.squaredLength=c.squaredLength),M=(e.sqrLen=d,e.normalize=c.normalize);e.exactEquals=c.exactEquals,e.equals=c.equals,e.rotationTo=function(){var t=l.create(),e=l.fromValues(1,0,0),r=l.fromValues(0,1,0);return function(a,n,i){var u=l.dot(n,i);return u<-.999999?(l.cross(t,e,n),l.len(t)<1e-6&&l.cross(t,r,n),l.normalize(t,t),o(a,t,Math.PI),a):u>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(l.cross(t,n,i),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+u,M(a,a))}}(),e.sqlerp=function(){var t=n(),e=n();return function(r,a,n,o,i,s){return u(t,a,i,s),u(e,n,o,s),u(r,t,e,2*s*(1-s)),r}}(),e.setAxes=function(){var t=h.create();return function(e,r,a,n){return t[0]=a[0],t[3]=a[1],t[6]=a[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],M(e,s(e,t))}}()},function(t,e,r){"use strict";function a(){var t=new l.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function n(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function o(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function i(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function u(t,e){var r=e[0]-t[0],a=e[1]-t[1];return Math.sqrt(r*r+a*a)}function s(t,e){var r=e[0]-t[0],a=e[1]-t[1];return r*r+a*a}function f(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function h(t){var e=t[0],r=t[1];return e*e+r*r}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=a,e.clone=function(t){var e=new l.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var r=new l.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,r){return t[0]=e,t[1]=r,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},e.subtract=n,e.multiply=o,e.divide=i,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},e.scaleAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t},e.distance=u,e.squaredDistance=s,e.length=f,e.squaredLength=h,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var r=e[0],a=e[1],n=r*r+a*a;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,r){var a=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=a,t},e.lerp=function(t,e,r,a){var n=e[0],o=e[1];return t[0]=n+a*(r[0]-n),t[1]=o+a*(r[1]-o),t},e.random=function(t,e){e=e||1;var r=2*l.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},e.transformMat2=function(t,e,r){var a=e[0],n=e[1];return t[0]=r[0]*a+r[2]*n,t[1]=r[1]*a+r[3]*n,t},e.transformMat2d=function(t,e,r){var a=e[0],n=e[1];return t[0]=r[0]*a+r[2]*n+r[4],t[1]=r[1]*a+r[3]*n+r[5],t},e.transformMat3=function(t,e,r){var a=e[0],n=e[1];return t[0]=r[0]*a+r[3]*n+r[6],t[1]=r[1]*a+r[4]*n+r[7],t},e.transformMat4=function(t,e,r){var a=e[0],n=e[1];return t[0]=r[0]*a+r[4]*n+r[12],t[1]=r[1]*a+r[5]*n+r[13],t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var r=t[0],a=t[1],n=e[0],o=e[1];return Math.abs(r-n)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(a-o)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))};var l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.len=f,e.sub=n,e.mul=o,e.div=i,e.dist=u,e.sqrDist=s,e.sqrLen=h,e.forEach=function(){var t=a();return function(e,r,a,n,o,i){var u,s=void 0;for(r||(r=2),a||(a=0),u=n?Math.min(n*r+a,e.length):e.length,s=a;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],o(t,t,i),e[s]=t[0],e[s+1]=t[1];return e}}()}])});class TriMesh{constructor(){this.isLoaded=!1,this.minXYZ=[0,0,0],this.maxXYZ=[0,0,0],this.numFaces=0,this.numVertices=0,this.vBuffer=[],this.fBuffer=[],this.nBuffer=[],this.eBuffer=[],this.texcoordBuffer=[],console.log("TriMesh: Allocated buffers"),null==gl.getExtension("OES_element_index_uint")?alert("OES_element_index_uint is unsupported by your browser and terrain generation cannot proceed."):console.log("OES_element_index_uint is supported!")}loaded(){return this.isLoaded}loadFromOBJ(t){for(var e=t.split("\n"),r=0;r<e.length;r++){e[r]=e[r].replace(/  +/g," ");var a=e[r].split(" ");"#"==a[0][0]?console.log(e[r]):"v"==a[0]?(this.vBuffer.push(parseFloat(a[1])),this.vBuffer.push(parseFloat(a[2])),this.vBuffer.push(parseFloat(a[3])),this.numVertices++):"f"==a[0]&&(this.fBuffer.push(parseInt(a[1])-1),this.fBuffer.push(parseInt(a[2])-1),this.fBuffer.push(parseInt(a[3])-1),this.numFaces++)}console.log("TriMesh: Loaded ",this.numFaces," triangles."),console.log("TriMesh: Loaded ",this.numVertices," vertices."),this.generateNormals(),console.log("TriMesh: Generated normals"),this.generateLines(),console.log("TriMesh: Generated lines"),this.loadBuffers(),this.isLoaded=!0}loadAsCube(){this.vBuffer=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],this.numVertices=this.vBuffer.length/3,this.fBuffer=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],this.numFaces=this.fBuffer.length/3,this.generateNormals(),console.log("TriMesh: Generated normals"),this.generateLines(),console.log("TriMesh: Generated lines"),this.loadBuffers(),this.isLoaded=!0}loadBuffers(){this.VertexPositionBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.VertexPositionBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vBuffer),gl.STATIC_DRAW),this.VertexPositionBuffer.itemSize=3,this.VertexPositionBuffer.numItems=this.numVertices,this.VertexNormalBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.VertexNormalBuffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.nBuffer),gl.STATIC_DRAW),this.VertexNormalBuffer.itemSize=3,this.VertexNormalBuffer.numItems=this.numVertices,this.IndexTriBuffer=gl.createBuffer(),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.IndexTriBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint32Array(this.fBuffer),gl.STATIC_DRAW),this.IndexTriBuffer.itemSize=1,this.IndexTriBuffer.numItems=this.fBuffer.length,this.IndexEdgeBuffer=gl.createBuffer(),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.IndexEdgeBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint32Array(this.eBuffer),gl.STATIC_DRAW),this.IndexEdgeBuffer.itemSize=1,this.IndexEdgeBuffer.numItems=this.eBuffer.length}drawTriangles(){gl.bindBuffer(gl.ARRAY_BUFFER,this.VertexPositionBuffer),gl.vertexAttribPointer(shaderProgram.vertexPositionAttribute,this.VertexPositionBuffer.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,this.VertexNormalBuffer),gl.vertexAttribPointer(shaderProgram.vertexNormalAttribute,this.VertexNormalBuffer.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.IndexTriBuffer),gl.drawElements(gl.TRIANGLES,this.IndexTriBuffer.numItems,gl.UNSIGNED_INT,0)}drawEdges(){gl.bindBuffer(gl.ARRAY_BUFFER,this.VertexPositionBuffer),gl.vertexAttribPointer(shaderProgram.vertexPositionAttribute,this.VertexPositionBuffer.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,this.VertexNormalBuffer),gl.vertexAttribPointer(shaderProgram.vertexNormalAttribute,this.VertexNormalBuffer.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.IndexEdgeBuffer),gl.drawElements(gl.LINES,this.IndexEdgeBuffer.numItems,gl.UNSIGNED_INT,0)}printBuffers(){for(var t=0;t<this.numVertices;t++)console.log("v ",this.vBuffer[3*t]," ",this.vBuffer[3*t+1]," ",this.vBuffer[3*t+2]," ");for(t=0;t<this.numFaces;t++)console.log("f ",this.fBuffer[3*t]," ",this.fBuffer[3*t+1]," ",this.fBuffer[3*t+2]," ")}generateLines(){for(var t=this.fBuffer.length/3,e=0;e<t;e++){var r=3*e;this.eBuffer.push(this.fBuffer[r]),this.eBuffer.push(this.fBuffer[r+1]),this.eBuffer.push(this.fBuffer[r+1]),this.eBuffer.push(this.fBuffer[r+2]),this.eBuffer.push(this.fBuffer[r+2]),this.eBuffer.push(this.fBuffer[r])}}generateCylindricalTexCoords(){for(var t=0;t<=this.div;t++)for(var e=0;e<=this.div;e++){var r=[0,0,0];this.getVertex(r,t,e),r[2]=.25*Math.random(),this.setVertex(r,t,e)}this.loadBuffers()}setVertex(t,e,r,a){var n=3*(i*(this.div+1)+j)+2;this.vBuffer[n]=h}getVertex(t,e){var r=3*t;e[0]=this.vBuffer[r],e[1]=this.vBuffer[r+1],e[2]=this.vBuffer[r+2]}flipNormals(){for(var t=0;t<this.nBuffer.length;t++)this.nBuffer[t]*=-1}scale(t){for(var e=0;e<this.vBuffer.length;e++)this.vBuffer[e]*=t}generateNormals(){this.numNormals=this.numVertices,this.nBuffer=new Array(3*this.numNormals);for(var t=0;t<this.nBuffer.length;t++)this.nBuffer[t]=0;for(t=0;t<this.numFaces;t++){var e=this.fBuffer[3*t],r=vec3.fromValues(this.vBuffer[3*e],this.vBuffer[3*e+1],this.vBuffer[3*e+2]),a=this.fBuffer[3*t+1],n=vec3.fromValues(this.vBuffer[3*a],this.vBuffer[3*a+1],this.vBuffer[3*a+2]),o=this.fBuffer[3*t+2],i=vec3.fromValues(this.vBuffer[3*o],this.vBuffer[3*o+1],this.vBuffer[3*o+2]),u=vec3.create();vec3.subtract(u,n,r);var s=vec3.create();vec3.subtract(s,i,r);var f=vec3.fromValues(0,0,0);vec3.cross(f,u,s);for(var h=0;h<3;h++)this.nBuffer[3*e+h]+=f[h],this.nBuffer[3*a+h]+=f[h],this.nBuffer[3*o+h]+=f[h]}for(t=0;t<this.numNormals;t++){f=vec3.fromValues(this.nBuffer[3*t],this.nBuffer[3*t+1],this.nBuffer[3*t+2]);vec3.normalize(f,f),this.nBuffer[3*t]=f[0],this.nBuffer[3*t+1]=f[1],this.nBuffer[3*t+2]=f[2]}}}var gl,canvas,shaderProgram;WebGLUtils=function(){var t=function(t){return'<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+t+"</div></div></td></tr></table>"},e='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',r='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>',a=function(t,e){for(var r=["webgl","experimental-webgl","webkit-3d","moz-webgl"],a=null,n=0;n<r.length;++n){try{a=t.getContext(r[n],e)}catch(t){}if(a)break}return a};return{create3DContext:a,setupWebGL:function(n,o,i){i=i||function(a){var o=n.parentNode;if(o){var i=window.WebGLRenderingContext?r:e;a&&(i+="<br/><br/>Status: "+a),o.innerHTML=t(i)}},n.addEventListener&&n.addEventListener("webglcontextcreationerror",function(t){i(t.statusMessage)},!1);var u=a(n,o);return u||window.WebGLRenderingContext||i(""),u}}}(),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)};var myMesh,cubeImage0,cubeImage1,cubeImage2,cubeImage3,cubeImage4,cubeImage5,cubeMap,cubeMesh,sphereMesh,animStartTime,lastTime,mMatrix=mat4.create(),vMatrix=mat4.create(),pMatrix=mat4.create(),nMatrix=mat3.create(),mMatrixStack=[],cubeScale=40,eyePt=vec3.fromValues(0,0,10),viewDir=vec3.fromValues(0,0,-1),upDir=vec3.fromValues(0,1,0),rightDir=vec3.fromValues(1,0,0),upRot=quat.create(),rightRot=quat.create(),finalRot=quat.create(),viewDirScaled=vec3.fromValues(0,0,-1),rightDirScaled=vec3.fromValues(1,0,0),viewPt=vec3.fromValues(0,0,0),teapotForward=vec3.fromValues(0,0,-1),teapotUp=vec3.fromValues(0,1,0),teapotRot=mat4.create(),teapotViewPt=vec3.create(),lightPosition=[40,40,40],lAmbient=[.1,.1,.1],lDiffuse=[1,1,1],lSpecular=[.7,.7,.7],kAmbient=[1,1,1],kTerrainDiffuse=[.7,.7,.7],kSpecular=[1,1,1],shininess=23,kEdgeBlack=[0,0,0],kEdgeWhite=[1,1,1],cubeImages=[cubeImage0,cubeImage1,cubeImage2,cubeImage3,cubeImage4,cubeImage5],spherePos=[0,0,0,0,0,0],sphereType=[1,0],MAX_SPHERES=10,sphereRotSeconds=5,sphereOrbitRadius=4,orbitTime=0,freeCam=!1,imgCt=0,currentlyPressedKeys={};function orbitMovement(t){var e=degToRad(360/sphereRotSeconds),r=0,a=0;currentlyPressedKeys.a&&(r+=e*t),currentlyPressedKeys.d&&(r-=e*t),currentlyPressedKeys.s&&(a+=e*t),currentlyPressedKeys.w&&(a-=e*t),quat.setAxisAngle(upRot,[0,1,0],r),quat.setAxisAngle(rightRot,teapotForward,a),quat.identity(finalRot),quat.mul(finalRot,upRot,finalRot),quat.mul(finalRot,rightRot,finalRot),vec3.transformQuat(teapotForward,teapotForward,finalRot),vec3.transformQuat(teapotUp,teapotUp,finalRot),currentlyPressedKeys.arrowup&&vec3.add(eyePt,eyePt,viewDirScaled),currentlyPressedKeys.arrowdown&&vec3.sub(eyePt,eyePt,viewDirScaled);var n=currentlyPressedKeys.arrowleft?-1:currentlyPressedKeys.arrowright?1:0;n*=e*t,vec3.rotateY(eyePt,eyePt,[0,0,0],n),vec3.rotateY(viewDir,viewDir,[0,0,0],n),vec3.rotateY(upDir,upDir,[0,0,0],n),vec3.rotateY(rightDir,rightDir,[0,0,0],n)}function freecamMovement(t){var e=degToRad(360/sphereRotSeconds);currentlyPressedKeys.w&&vec3.add(eyePt,eyePt,viewDirScaled),currentlyPressedKeys.s&&vec3.sub(eyePt,eyePt,viewDirScaled),currentlyPressedKeys.a&&vec3.sub(eyePt,eyePt,rightDirScaled),currentlyPressedKeys.d&&vec3.add(eyePt,eyePt,rightDirScaled);var r=0,a=0;currentlyPressedKeys.arrowleft&&(r+=.8*e*t),currentlyPressedKeys.arrowright&&(r-=.8*e*t),currentlyPressedKeys.arrowup&&(a+=.8*e*t),currentlyPressedKeys.arrowdown&&(a-=.8*e*t),quat.setAxisAngle(upRot,[0,1,0],r),quat.setAxisAngle(rightRot,rightDir,a),quat.identity(finalRot),quat.mul(finalRot,upRot,finalRot),quat.mul(finalRot,rightRot,finalRot),vec3.transformQuat(viewDir,viewDir,finalRot),vec3.transformQuat(upDir,upDir,finalRot),vec3.transformQuat(rightDir,rightDir,finalRot)}function draw(){gl.viewport(0,0,gl.viewportWidth,gl.viewportHeight),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);var t=(performance.now()-animStartTime)/1e3,e=t-lastTime;lastTime=t,vec3.scale(viewDirScaled,viewDir,5*e),vec3.scale(rightDirScaled,rightDir,5*e),freeCam?freecamMovement(e):orbitMovement(e);var r=document.getElementById("orbitSpeed").value;orbitTime+=e*r*2/100;for(var a=0;a<sphereType.length;a++){var n=document.getElementById("orbitOffset").value/100,o=(a+.5)/(2*sphereType.length),i=Math.cos(2*o*Math.PI),u=Math.sin(2*o*Math.PI),s=Math.cos((orbitTime+2*o*n*sphereRotSeconds)*Math.PI*2/sphereRotSeconds),f=Math.sin((orbitTime+2*o*n*sphereRotSeconds)*Math.PI*2/sphereRotSeconds);setSpherePos(a,sphereOrbitRadius*i*f,sphereOrbitRadius*u*f,sphereOrbitRadius*s)}if(mat4.perspective(pMatrix,degToRad(45),gl.viewportWidth/gl.viewportHeight,.1,500),vec3.add(viewPt,eyePt,viewDir),mat4.lookAt(vMatrix,eyePt,viewPt,upDir),setLightUniforms(lightPosition,lAmbient,lDiffuse,lSpecular),0!=sphereType.length&&(gl.uniform3fv(gl.getUniformLocation(shaderProgram,"spherePos"),spherePos),gl.uniform1iv(gl.getUniformLocation(shaderProgram,"sphereType"),sphereType)),gl.uniform1i(gl.getUniformLocation(shaderProgram,"numSpheres"),sphereType.length),gl.uniform3fv(gl.getUniformLocation(shaderProgram,"eyePos"),eyePt),setMaterialUniforms(shininess,kAmbient,kTerrainDiffuse,kSpecular),1==myMesh.loaded()){var h=document.getElementById("reflective").checked?2:0;gl.uniform1i(gl.getUniformLocation(shaderProgram,"uMode"),h),mPushMatrix(),mat4.translate(mMatrix,mMatrix,[0,-1,0]),mat4.translate(mMatrix,mMatrix,[0,.5,0]),vec3.add(teapotViewPt,[0,0,0],teapotForward),mat4.targetTo(teapotRot,[0,0,0],teapotViewPt,teapotUp),mat4.mul(mMatrix,teapotRot,mMatrix),mat4.translate(mMatrix,mMatrix,[0,-.5,0]),setMatrixUniforms(),myMesh.drawTriangles(),mPopMatrix()}if(1==sphereMesh.loaded())for(a=0;a<sphereType.length;a++)mPushMatrix(),gl.uniform1i(gl.getUniformLocation(shaderProgram,"uMode"),0==sphereType[a]?2:3),mat4.translate(mMatrix,mMatrix,getSpherePos(a)),setMatrixUniforms(),sphereMesh.drawTriangles(),mPopMatrix();mPushMatrix(),gl.uniform1i(gl.getUniformLocation(shaderProgram,"uMode"),1),gl.uniform1i(gl.getUniformLocation(shaderProgram,"uCubeSampler"),0),mat4.scale(mMatrix,mMatrix,[cubeScale,cubeScale,cubeScale]),setMatrixUniforms(),cubeMesh.drawTriangles(),mPopMatrix()}function setSpherePos(t,e,r,a){spherePos[3*t]=e,spherePos[3*t+1]=r,spherePos[3*t+2]=a}function getSpherePos(t){return[spherePos[3*t],spherePos[3*t+1],spherePos[3*t+2]]}function addSphere(t){sphereType.length>=MAX_SPHERES||(spherePos.push(0,2,0),sphereType.push(t))}function removeLastSphere(){sphereType.pop(),spherePos.pop(),spherePos.pop(),spherePos.pop()}function handleKeyDown(t){var e=t.key.toLowerCase();currentlyPressedKeys[e]=!0,"arrowup"!=e&&"arrowleft"!=e&&"arrowright"!=e&&"arrowdown"!=e||t.preventDefault(),"e"==e&&addSphere(1),"r"==e&&addSphere(0),"t"==e&&removeLastSphere()," "==e&&(freeCam=!freeCam)}function handleKeyUp(t){currentlyPressedKeys[t.key.toLowerCase()]=!1}function onResize(){canvas.width=window.innerWidth,canvas.height=window.innerHeight,gl.viewportWidth=canvas.width,gl.viewportHeight=canvas.height}function startup(){canvas=document.getElementById("myGLCanvas"),gl=createGLContext(canvas),setupShaders(),setupTextures(),initCube(),initSphere(),setupMesh("teapot.obj"),gl.clearColor(0,0,0,1),gl.enable(gl.DEPTH_TEST),document.onkeydown=handleKeyDown,document.onkeyup=handleKeyUp,animStartTime=performance.now(),window.addEventListener("resize",onResize,!1),onResize(),lastTime=(performance.now()-animStartTime)/1e3,tick()}function tick(){requestAnimFrame(tick),6==imgCt&&draw()}function setupShaders(){vertexShader=loadShaderFromDOM("shader-vs"),fragmentShader=loadShaderFromDOM("shader-fs"),shaderProgram=gl.createProgram(),gl.attachShader(shaderProgram,vertexShader),gl.attachShader(shaderProgram,fragmentShader),gl.linkProgram(shaderProgram),gl.getProgramParameter(shaderProgram,gl.LINK_STATUS)||alert("Failed to setup shaders"),gl.useProgram(shaderProgram),shaderProgram.vertexPositionAttribute=gl.getAttribLocation(shaderProgram,"aVertexPosition"),gl.enableVertexAttribArray(shaderProgram.vertexPositionAttribute),shaderProgram.vertexNormalAttribute=gl.getAttribLocation(shaderProgram,"aVertexNormal"),gl.enableVertexAttribArray(shaderProgram.vertexNormalAttribute),shaderProgram.mMatrixUniform=gl.getUniformLocation(shaderProgram,"uMMatrix"),shaderProgram.vMatrixUniform=gl.getUniformLocation(shaderProgram,"uVMatrix"),shaderProgram.pMatrixUniform=gl.getUniformLocation(shaderProgram,"uPMatrix"),shaderProgram.nMatrixUniform=gl.getUniformLocation(shaderProgram,"uNMatrix"),shaderProgram.uniformLightPositionLoc=gl.getUniformLocation(shaderProgram,"uLightPosition"),shaderProgram.uniformAmbientLightColorLoc=gl.getUniformLocation(shaderProgram,"uAmbientLightColor"),shaderProgram.uniformDiffuseLightColorLoc=gl.getUniformLocation(shaderProgram,"uDiffuseLightColor"),shaderProgram.uniformSpecularLightColorLoc=gl.getUniformLocation(shaderProgram,"uSpecularLightColor"),shaderProgram.uniformShininessLoc=gl.getUniformLocation(shaderProgram,"uShininess"),shaderProgram.uniformAmbientMaterialColorLoc=gl.getUniformLocation(shaderProgram,"uKAmbient"),shaderProgram.uniformDiffuseMaterialColorLoc=gl.getUniformLocation(shaderProgram,"uKDiffuse"),shaderProgram.uniformSpecularMaterialColorLoc=gl.getUniformLocation(shaderProgram,"uKSpecular")}function uploadModelViewMatrixToShader(){gl.uniformMatrix4fv(shaderProgram.mMatrixUniform,!1,mMatrix),gl.uniformMatrix4fv(shaderProgram.vMatrixUniform,!1,vMatrix)}function uploadProjectionMatrixToShader(){gl.uniformMatrix4fv(shaderProgram.pMatrixUniform,!1,pMatrix)}function uploadNormalMatrixToShader(){mat3.fromMat4(nMatrix,mMatrix),mat3.transpose(nMatrix,nMatrix),mat3.invert(nMatrix,nMatrix),gl.uniformMatrix3fv(shaderProgram.nMatrixUniform,!1,nMatrix)}function setMatrixUniforms(){uploadModelViewMatrixToShader(),uploadNormalMatrixToShader(),uploadProjectionMatrixToShader()}function setMaterialUniforms(t,e,r,a){gl.uniform1f(shaderProgram.uniformShininessLoc,t),gl.uniform3fv(shaderProgram.uniformAmbientMaterialColorLoc,e),gl.uniform3fv(shaderProgram.uniformDiffuseMaterialColorLoc,r),gl.uniform3fv(shaderProgram.uniformSpecularMaterialColorLoc,a)}function setLightUniforms(t,e,r,a){gl.uniform3fv(shaderProgram.uniformLightPositionLoc,t),gl.uniform3fv(shaderProgram.uniformAmbientLightColorLoc,e),gl.uniform3fv(shaderProgram.uniformDiffuseLightColorLoc,r),gl.uniform3fv(shaderProgram.uniformSpecularLightColorLoc,a)}function handleTextureLoaded(t,e){console.log("handleTextureLoaded, image = "+t),gl.bindTexture(gl.TEXTURE_CUBE_MAP,cubeMap),0==e?gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Z,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t):1==e?gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t):2==e?gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Y,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t):3==e?gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t):4==e?gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t):5==e&&gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_X,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t),gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_MAG_FILTER,gl.LINEAR),imgCt++}function initCube(){(cubeMesh=new TriMesh).loadAsCube()}function initSphere(){sphereMesh=new TriMesh,myPromise=asyncGetFile("sphere.obj"),myPromise.then(t=>{sphereMesh.loadFromOBJ(t),sphereMesh.scale(.3),sphereMesh.loadBuffers(),console.log("Yay! got the file")}).catch(t=>{console.log("Handle rejected promise ("+t+") here.")})}function setupMesh(t){myMesh=new TriMesh,myPromise=asyncGetFile(t),myPromise.then(t=>{myMesh.loadFromOBJ(t),console.log("Yay! got the file")}).catch(t=>{console.log("Handle rejected promise ("+t+") here.")})}function setupPromise(t,e){myPromise=asyncGetFileCube(t,e),myPromise.then(t=>{handleTextureLoaded(cubeImages[e],e),console.log("Yay! got the file")}).catch(t=>{console.log("Handle rejected promise ("+t+") here.")})}function setupTextures(){cubeMap=gl.createTexture(),setupPromise("pos-z.png",0),setupPromise("neg-z.png",1),setupPromise("pos-y.png",2),setupPromise("neg-y.png",3),setupPromise("pos-x.png",4),setupPromise("neg-x.png",5)}function loadShaderFromDOM(t){var e=document.getElementById(t);if(!e)return null;for(var r,a="",n=e.firstChild;n;)3==n.nodeType&&(a+=n.textContent),n=n.nextSibling;if("x-shader/x-fragment"==e.type)r=gl.createShader(gl.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!=e.type)return null;r=gl.createShader(gl.VERTEX_SHADER)}return gl.shaderSource(r,a),gl.compileShader(r),gl.getShaderParameter(r,gl.COMPILE_STATUS)?r:(alert(gl.getShaderInfoLog(r)),null)}function mPushMatrix(){var t=mat4.clone(mMatrix);mMatrixStack.push(t)}function mPopMatrix(){if(0==mMatrixStack.length)throw"Invalid popMatrix!";mMatrix=mMatrixStack.pop()}function asyncGetFileCube(t,e){return console.log("Getting image"),new Promise((r,a)=>{cubeImages[e]=new Image,cubeImages[e].onload=(()=>r({url:t,status:"ok"})),cubeImages[e].onerror=(()=>a({url:t,status:"error"})),cubeImages[e].src=t,console.log("Made promise")})}function asyncGetFile(t){return console.log("Getting text file"),new Promise((e,r)=>{const a=new XMLHttpRequest;a.open("GET",t),a.onload=(()=>e(a.responseText)),a.onerror=(()=>r(a.statusText)),a.send(),console.log("Made promise")})}function degToRad(t){return t*Math.PI/180}function createGLContext(t){for(var e=["webgl","experimental-webgl"],r=null,a=0;a<e.length;a++){try{r=t.getContext(e[a])}catch(t){}if(r)break}return r?(r.viewportWidth=t.width,r.viewportHeight=t.height):alert("Failed to create WebGL context!"),r}
